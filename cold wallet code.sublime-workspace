{
	"auto_complete":
	{
		"selected_items":
		[
		]
	},
	"buffers":
	[
		{
			"file": "main.py",
			"settings":
			{
				"buffer_size": 10196,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					330,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAuSAAAAAAAAAAAAAAuSAAAAAAAAC5IAAAAAAAAJYeAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0dGtib290c3RyYXAuY29uc3RhbnRzIGltcG9ydCAqCmZyb20gdHRrYm9vdHN0cmFwLnN0eWxlIGltcG9ydCBCb290c3R5bGUKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIHRraW50ZXIgaW1wb3J0IG1lc3NhZ2Vib3gKCiMgUGF0aCB0byBzdG9yZSB0aGUgZW5jcnlwdGVkIHdhbGxldCBpbmZvcm1hdGlvbgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgojIEdlbmVyYXRlIG9yIGxvYWQgZW5jcnlwdGlvbiBrZXkKZGVmIGxvYWRfa2V5KCk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cygic2VjcmV0LmtleSIpOgogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJyYiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICByZXR1cm4ga2V5X2ZpbGUucmVhZCgpCiAgICBlbHNlOgogICAgICAgIGtleSA9IEZlcm5ldC5nZW5lcmF0ZV9rZXkoKQogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJ3YiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICBrZXlfZmlsZS53cml0ZShrZXkpCiAgICAgICAgcmV0dXJuIGtleQoKIyBFbmNyeXB0IGRhdGEKZGVmIGVuY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZW5jcnlwdChkYXRhLmVuY29kZSgpKQoKIyBEZWNyeXB0IGRhdGEKZGVmIGRlY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZGVjcnlwdChkYXRhKS5kZWNvZGUoKQoKIyBMb2FkIG9yIGNyZWF0ZSBhIG5ldyBQSU4KZGVmIGdldF9waW4oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFBJTl9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJyYiIpIGFzIHBpbl9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfcGluID0gcGluX2ZpbGUucmVhZCgpCiAgICAgICAgcGluID0gZGVjcnlwdChlbmNyeXB0ZWRfcGluLCBrZXkpCiAgICBlbHNlOgogICAgICAgIHBpbiA9IE5vbmUKICAgIHJldHVybiBwaW4KCiMgU2F2ZSBhIG5ldyBQSU4KZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCiMgVmVyaWZ5IFBJTgpkZWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICBpZiBlbnRlcmVkX3BpbiA9PSBzdG9yZWRfcGluOgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJJbmNvcnJlY3QgUElOLiIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgojIENyZWF0ZSBvciBsb2FkIHdhbGxldCBpbmZvcm1hdGlvbgpkZWYgbG9hZF93YWxsZXRfaW5mbyhrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoV0FMTEVUX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgInJiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gd2FsbGV0X2ZpbGUucmVhZCgpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSwga2V5KSkKICAgIGVsc2U6CiAgICAgICAgIyBFeGFtcGxlIHdhbGxldCBpbmZvcm1hdGlvbiBzdHJ1Y3R1cmUKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKIyBTYXZlIHdhbGxldCBpbmZvcm1hdGlvbgpkZWYgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KToKICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgIndiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSBlbmNyeXB0KGpzb24uZHVtcHMod2FsbGV0X2luZm8pLCBrZXkpCiAgICAgICAgd2FsbGV0X2ZpbGUud3JpdGUoZW5jcnlwdGVkX2RhdGEpCgpkZWYgZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0ID0gV2FsbGV0LmNyZWF0ZShmJ1VTQldhbGxldF97Y3J5cHRvX3R5cGV9JykKICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgIHJldHVybiBrZXkuYWRkcmVzcwoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gcGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBwaW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgb3Blbl93YWxsZXRfd2luZG93KCkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBwaW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIHBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBvcGVuX3dhbGxldF93aW5kb3coKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgb3Blbl93YWxsZXRfd2luZG93KCk6CiAgICB3YWxsZXRfd2luZG93ID0gdGsuVG9wbGV2ZWwocGluX3dpbmRvdykKICAgIHdhbGxldF93aW5kb3cudGl0bGUoIlVTQiBXYWxsZXQgSW5mb3JtYXRpb24iKQogICAgd2FsbGV0X3dpbmRvdy5nZW9tZXRyeSgiNTAweDUwMCIpCgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKCiAgICAjIFdhbGxldCBJbmZvcm1hdGlvbiBGcmFtZQogICAgd2FsbGV0X2ZyYW1lID0gdHRrLkZyYW1lKHdhbGxldF93aW5kb3csIHBhZGRpbmc9KDIwLCAxMCkpCiAgICB3YWxsZXRfZnJhbWUucGFjayhmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgd2FsbGV0X2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iV2FsbGV0IEluZm9ybWF0aW9uIiwgZm9udD0oIkhlbHZldGljYSIsIDE2LCAiYm9sZCIpLCBib290c3R5bGU9InByaW1hcnkiKQogICAgd2FsbGV0X2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTIsIHBhZHk9MTApCgogICAgIyBEaXNwbGF5aW5nIFdhbGxldCBJbmZvCiAgICByb3cgPSAxCiAgICBmb3IgY3J5cHRvLCBpbmZvIGluIHdhbGxldF9pbmZvLml0ZW1zKCk6CiAgICAgICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1mIntjcnlwdG8uY2FwaXRhbGl6ZSgpfSBBZGRyZXNzOiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICAgICAgY3J5cHRvX2xhYmVsLmdyaWQocm93PXJvdywgY29sdW1uPTAsIHN0aWNreT0iZSIsIHBhZHk9NSkKCiAgICAgICAgY3J5cHRvX3ZhbHVlID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1pbmZvWyJ3YWxsZXQiXSwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJkZWZhdWx0IikKICAgICAgICBjcnlwdG9fdmFsdWUuZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgICAgICByb3cgKz0gMQoKICAgICMgQ3J5cHRvY3VycmVuY3kgc2VsZWN0aW9uCiAgICBjcnlwdG9fbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PSJTZWxlY3QgQ3J5cHRvY3VycmVuY3k6IiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJpbmZvIikKICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUpCgogICAgY3J5cHRvX29wdGlvbnMgPSBbImJpdGNvaW4iLCAiZXRoZXJldW0iLCAieHJwIiwgInNoaWJhX2ludSJdCiAgICBzZWxlY3RlZF9jcnlwdG8gPSB0ay5TdHJpbmdWYXIoKQogICAgc2VsZWN0ZWRfY3J5cHRvLnNldChjcnlwdG9fb3B0aW9uc1swXSkgICMgRGVmYXVsdCB2YWx1ZQoKICAgIGNyeXB0b19kcm9wZG93biA9IHR0ay5Db21ib2JveCh3YWxsZXRfZnJhbWUsIHRleHR2YXJpYWJsZT1zZWxlY3RlZF9jcnlwdG8sIHZhbHVlcz1jcnlwdG9fb3B0aW9ucywgc3RhdGU9InJlYWRvbmx5IikKICAgIGNyeXB0b19kcm9wZG93bi5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgcm93ICs9IDEKCiAgICBnZW5lcmF0ZV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iR2VuZXJhdGUgTmV3IEFkZHJlc3MiLCBjb21tYW5kPWxhbWJkYTogb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIHNlbGVjdGVkX2NyeXB0by5nZXQoKSksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIGdlbmVyYXRlX2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTIsIHBhZHk9MjApCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcyA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBVcGRhdGluZyB0aGUgZGlzcGxheQogICAgZm9yIHdpZGdldCBpbiB3YWxsZXRfZnJhbWUud2luZm9fY2hpbGRyZW4oKToKICAgICAgICB3aWRnZXQuZGVzdHJveSgpCgogICAgd2FsbGV0X2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iV2FsbGV0IEluZm9ybWF0aW9uIiwgZm9udD0oIkhlbHZldGljYSIsIDE2LCAiYm9sZCIpLCBib290c3R5bGU9InByaW1hcnkiKQogICAgd2FsbGV0X2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTIsIHBhZHk9MTApCgogICAgcm93ID0gMQogICAgZm9yIGNyeXB0bywgaW5mbyBpbiB3YWxsZXRfaW5mby5pdGVtcygpOgogICAgICAgIGNyeXB0b19sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9ZiJ7Y3J5cHRvLmNhcGl0YWxpemUoKX0gQWRkcmVzczoiLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImluZm8iKQogICAgICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUpCgogICAgICAgIGNyeXB0b192YWx1ZSA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9aW5mb1sid2FsbGV0Il0sIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iZGVmYXVsdCIpCiAgICAgICAgY3J5cHRvX3ZhbHVlLmdyaWQocm93PXJvdywgY29sdW1uPTEsIHN0aWNreT0idyIsIHBhZHk9NSkKCiAgICAgICAgcm93ICs9IDEKCiAgICAjIENyeXB0b2N1cnJlbmN5IHNlbGVjdGlvbgogICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iU2VsZWN0IENyeXB0b2N1cnJlbmN5OiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgIGNyeXB0b19vcHRpb25zID0gWyJiaXRjb2luIiwgImV0aGVyZXVtIiwgInhycCIsICJzaGliYV9pbnUiXQogICAgc2VsZWN0ZWRfY3J5cHRvID0gdGsuU3RyaW5nVmFyKCkKICAgIHNlbGVjdGVkX2NyeXB0by5zZXQoY3J5cHRvX29wdGlvbnNbMF0pICAjIERlZmF1bHQgdmFsdWUKCiAgICBjcnlwdG9fZHJvcGRvd24gPSB0dGsuQ29tYm9ib3god2FsbGV0X2ZyYW1lLCB0ZXh0dmFyaWFibGU9c2VsZWN0ZWRfY3J5cHRvLCB2YWx1ZXM9Y3J5cHRvX29wdGlvbnMsIHN0YXRlPSJyZWFkb25seSIpCiAgICBjcnlwdG9fZHJvcGRvd24uZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgIHJvdyArPSAxCgogICAgZ2VuZXJhdGVfYnV0dG9uID0gdHRrLkJ1dHRvbih3YWxsZXRfZnJhbWUsIHRleHQ9IkdlbmVyYXRlIE5ldyBBZGRyZXNzIiwgY29tbWFuZD1sYW1iZGE6IG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBzZWxlY3RlZF9jcnlwdG8uZ2V0KCkpLCBib290c3R5bGU9InN1Y2Nlc3Mtb3V0bGluZSIpCiAgICBnZW5lcmF0ZV9idXR0b24uZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgY29sdW1uc3Bhbj0yLCBwYWR5PTIwKQoKICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCBmIk5ldyB7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfSBhZGRyZXNzIGdlbmVyYXRlZCBhbmQgc2F2ZWQuIikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBrZXkgPSBsb2FkX2tleSgpCiAgICBwaW4gPSBnZXRfcGluKGtleSkKCiAgICBwaW5fd2luZG93ID0gdHRrLldpbmRvdyh0aGVtZW5hbWU9ImRhcmtseSIpCiAgICBwaW5fd2luZG93LnRpdGxlKCJVU0IgV2FsbGV0IC0gUElOIEVudHJ5IikKICAgIHBpbl93aW5kb3cuZ2VvbWV0cnkoIjQwMHgyMDAiKQoKICAgIHBpbl9sYWJlbCA9IHR0ay5MYWJlbChwaW5fd2luZG93LCB0ZXh0PSJFbnRlciB5b3VyIFBJTjoiLCBib290c3R5bGU9InByaW1hcnkiKQogICAgcGluX2xhYmVsLnBhY2socGFkeT0xMCkKCiAgICBwaW5fZW50cnkgPSB0dGsuRW50cnkocGluX3dpbmRvdywgc2hvdz0nKicsIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICBwaW5fZW50cnkucGFjayhwYWR5PTEwKQoKICAgIGlmIHBpbiBpcyBOb25lOgogICAgICAgIHBpbl9jb25maXJtX2xhYmVsID0gdHRrLkxhYmVsKHBpbl93aW5kb3csIHRleHQ9IkNvbmZpcm0geW91ciBQSU46IiwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgICAgICBwaW5fY29uZmlybV9sYWJlbC5wYWNrKHBhZHk9MTApCgogICAgICAgIHBpbl9jb25maXJtX2VudHJ5ID0gdHRrLkVudHJ5KHBpbl93aW5kb3csIHNob3c9JyonLCBib290c3R5bGU9InByaW1hcnkiKQogICAgICAgIHBpbl9jb25maXJtX2VudHJ5LnBhY2socGFkeT0xMCkKCiAgICBwaW5fZW50cnkuYmluZCgiPFJldHVybj4iLCBvbl9waW5fZW50cnkpCiAgICBpZiBwaW4gaXMgTm9uZToKICAgICAgICBwaW5fY29uZmlybV9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKCiAgICBzdWJtaXRfYnV0dG9uID0gdHRrLkJ1dHRvbihwaW5fd2luZG93LCB0ZXh0PSJTdWJtaXQgUElOIiwgY29tbWFuZD1vbl9waW5fZW50cnksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIHN1Ym1pdF9idXR0b24ucGFjayhwYWR5PTEwKQoKICAgIHBpbl93aW5kb3cubWFpbmxvb3AoKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAJYeAAAAAAAAAAAAAAAA8L8"
				],
				[
					335,
					1,
					"paste",
					null,
					"AgAAAKYgAAAAAAAAUiEAAAAAAAAAAAAAUiEAAAAAAABSIQAAAAAAABMAAAAgICAgc3VibWl0X2J1dHRvbiA9",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACmIAAAAAAAALkgAAAAAAAAAAAAAAAA8L8"
				],
				[
					344,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAANSAAAAAAAAAAAAAANSAAAAAAAAA1IAAAAAAAAFIhAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0dGtib290c3RyYXAuY29uc3RhbnRzIGltcG9ydCAqCmZyb20gdHRrYm9vdHN0cmFwLnN0eWxlIGltcG9ydCBCb290c3R5bGUKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIHRraW50ZXIgaW1wb3J0IG1lc3NhZ2Vib3gsIHNpbXBsZWRpYWxvZwoKIyBQYXRoIHRvIHN0b3JlIHRoZSBlbmNyeXB0ZWQgd2FsbGV0IGluZm9ybWF0aW9uCldBTExFVF9GSUxFID0gIndhbGxldF9pbmZvLmVuYyIKUElOX0ZJTEUgPSAicGluLmVuYyIKCiMgR2VuZXJhdGUgb3IgbG9hZCBlbmNyeXB0aW9uIGtleQpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgojIEVuY3J5cHQgZGF0YQpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgojIERlY3J5cHQgZGF0YQpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgojIExvYWQgb3IgY3JlYXRlIGEgbmV3IFBJTgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKIyBTYXZlIGEgbmV3IFBJTgpkZWYgc2V0X3BpbihuZXdfcGluLCBrZXkpOgogICAgZW5jcnlwdGVkX3BpbiA9IGVuY3J5cHQobmV3X3Bpbiwga2V5KQogICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAid2IiKSBhcyBwaW5fZmlsZToKICAgICAgICBwaW5fZmlsZS53cml0ZShlbmNyeXB0ZWRfcGluKQoKIyBWZXJpZnkgUElOCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCiMgQ3JlYXRlIG9yIGxvYWQgd2FsbGV0IGluZm9ybWF0aW9uCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICAjIEV4YW1wbGUgd2FsbGV0IGluZm9ybWF0aW9uIHN0cnVjdHVyZQogICAgICAgIHdhbGxldF9pbmZvID0gewogICAgICAgICAgICAiYml0Y29pbiI6IHsid2FsbGV0IjogImJpdGNvaW5fd2FsbGV0X2FkZHJlc3MiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAic2hpYmFfaW51IjogeyJ3YWxsZXQiOiAic2hpYmFfd2FsbGV0X2FkZHJlc3MiLCAiYmFsYW5jZSI6IDAuMH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdhbGxldF9pbmZvCgojIFNhdmUgd2FsbGV0IGluZm9ybWF0aW9uCmRlZiBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpOgogICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAid2IiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IGVuY3J5cHQoanNvbi5kdW1wcyh3YWxsZXRfaW5mbyksIGtleSkKICAgICAgICB3YWxsZXRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKCmRlZiBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAga2V5ID0gd2FsbGV0Lm5ld19rZXkoKQogICAgcmV0dXJuIGtleS5hZGRyZXNzCgpkZWYgb25fcGluX2VudHJ5KGV2ZW50PU5vbmUpOgogICAgc3RvcmVkX3BpbiA9IGdldF9waW4oa2V5KQogICAgZW50ZXJlZF9waW4gPSBwaW5fZW50cnkuZ2V0KCkKICAgIGlmIHN0b3JlZF9waW46CiAgICAgICAgaWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICAgICAgICAgIHBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBvcGVuX3dhbGxldF93aW5kb3coKQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IHBpbl9jb25maXJtX2VudHJ5LmdldCgpCiAgICAgICAgaWYgZW50ZXJlZF9waW4gPT0gY29uZmlybV9waW46CiAgICAgICAgICAgIHNldF9waW4oZW50ZXJlZF9waW4sIGtleSkKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygiU3VjY2VzcyIsICJOZXcgUElOIHNldCBzdWNjZXNzZnVsbHkuIikKICAgICAgICAgICAgcGluX3dpbmRvdy53aXRoZHJhdygpCiAgICAgICAgICAgIG9wZW5fd2FsbGV0X3dpbmRvdygpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiBvcGVuX3dhbGxldF93aW5kb3coKToKICAgIHdhbGxldF93aW5kb3cgPSB0ay5Ub3BsZXZlbChwaW5fd2luZG93KQogICAgd2FsbGV0X3dpbmRvdy50aXRsZSgiVVNCIFdhbGxldCBJbmZvcm1hdGlvbiIpCiAgICB3YWxsZXRfd2luZG93Lmdlb21ldHJ5KCI1MDB4NTAwIikKCiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQoKICAgICMgV2FsbGV0IEluZm9ybWF0aW9uIEZyYW1lCiAgICB3YWxsZXRfZnJhbWUgPSB0dGsuRnJhbWUod2FsbGV0X3dpbmRvdywgcGFkZGluZz0oMjAsIDEwKSkKICAgIHdhbGxldF9mcmFtZS5wYWNrKGZpbGw9ImJvdGgiLCBleHBhbmQ9VHJ1ZSkKCiAgICB3YWxsZXRfbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PSJXYWxsZXQgSW5mb3JtYXRpb24iLCBmb250PSgiSGVsdmV0aWNhIiwgMTYsICJib2xkIiksIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICB3YWxsZXRfbGFiZWwuZ3JpZChyb3c9MCwgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0xMCkKCiAgICAjIERpc3BsYXlpbmcgV2FsbGV0IEluZm8KICAgIHJvdyA9IDEKICAgIGZvciBjcnlwdG8sIGluZm8gaW4gd2FsbGV0X2luZm8uaXRlbXMoKToKICAgICAgICBjcnlwdG9fbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PWYie2NyeXB0by5jYXBpdGFsaXplKCl9IEFkZHJlc3M6IiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJpbmZvIikKICAgICAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgICAgICBjcnlwdG9fdmFsdWUgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PWluZm9bIndhbGxldCJdLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImRlZmF1bHQiKQogICAgICAgIGNyeXB0b192YWx1ZS5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgICAgIGNvcHlfYnV0dG9uID0gdHRrLkJ1dHRvbih3YWxsZXRfZnJhbWUsIHRleHQ9IkNvcHkiLCBjb21tYW5kPWxhbWJkYSBhZGRyZXNzPWluZm9bIndhbGxldCJdOiBjb3B5X3RvX2NsaXBib2FyZChhZGRyZXNzKSwgYm9vdHN0eWxlPSJpbmZvLW91dGxpbmUiKQogICAgICAgIGNvcHlfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTIsIHN0aWNreT0idyIsIHBhZHk9NSwgcGFkeD01KQoKICAgICAgICByb3cgKz0gMQoKICAgICMgQ3J5cHRvY3VycmVuY3kgc2VsZWN0aW9uCiAgICBjcnlwdG9fbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PSJTZWxlY3QgQ3J5cHRvY3VycmVuY3k6IiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJpbmZvIikKICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUpCgogICAgY3J5cHRvX29wdGlvbnMgPSBbImJpdGNvaW4iLCAiZXRoZXJldW0iLCAieHJwIiwgInNoaWJhX2ludSJdCiAgICBzZWxlY3RlZF9jcnlwdG8gPSB0ay5TdHJpbmdWYXIoKQogICAgc2VsZWN0ZWRfY3J5cHRvLnNldChjcnlwdG9fb3B0aW9uc1swXSkgICMgRGVmYXVsdCB2YWx1ZQoKICAgIGNyeXB0b19kcm9wZG93biA9IHR0ay5Db21ib2JveCh3YWxsZXRfZnJhbWUsIHRleHR2YXJpYWJsZT1zZWxlY3RlZF9jcnlwdG8sIHZhbHVlcz1jcnlwdG9fb3B0aW9ucywgc3RhdGU9InJlYWRvbmx5IikKICAgIGNyeXB0b19kcm9wZG93bi5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgcm93ICs9IDEKCiAgICBnZW5lcmF0ZV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iR2VuZXJhdGUgTmV3IEFkZHJlc3MiLCBjb21tYW5kPWxhbWJkYTogb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIHNlbGVjdGVkX2NyeXB0by5nZXQoKSksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIGdlbmVyYXRlX2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MjApCgpkZWYgY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyk6CiAgICBwaW5fd2luZG93LmNsaXBib2FyZF9jbGVhcigpCiAgICBwaW5fd2luZG93LmNsaXBib2FyZF9hcHBlbmQoYWRkcmVzcykKICAgIHBpbl93aW5kb3cudXBkYXRlKCkgICMgS2VlcCB0aGUgY2xpcGJvYXJkIGRhdGEgYXZhaWxhYmxlCiAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJDb3BpZWQiLCAiQWRkcmVzcyBjb3BpZWQgdG8gY2xpcGJvYXJkLiIpCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcyA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBVcGRhdGluZyB0aGUgZGlzcGxheQogICAgZm9yIHdpZGdldCBpbiB3YWxsZXRfZnJhbWUud2luZm9fY2hpbGRyZW4oKToKICAgICAgICB3aWRnZXQuZGVzdHJveSgpCgogICAgd2FsbGV0X2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iV2FsbGV0IEluZm9ybWF0aW9uIiwgZm9udD0oIkhlbHZldGljYSIsIDE2LCAiYm9sZCIpLCBib290c3R5bGU9InByaW1hcnkiKQogICAgd2FsbGV0X2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MTApCgogICAgcm93ID0gMQogICAgZm9yIGNyeXB0bywgaW5mbyBpbiB3YWxsZXRfaW5mby5pdGVtcygpOgogICAgICAgIGNyeXB0b19sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9ZiJ7Y3J5cHRvLmNhcGl0YWxpemUoKX0gQWRkcmVzczoiLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImluZm8iKQogICAgICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUpCgogICAgICAgIGNyeXB0b192YWx1ZSA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9aW5mb1sid2FsbGV0Il0sIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iZGVmYXVsdCIpCiAgICAgICAgY3J5cHRvX3ZhbHVlLmdyaWQocm93PXJvdywgY29sdW1uPTEsIHN0aWNreT0idyIsIHBhZHk9NSkKCiAgICAgICAgY29weV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iQ29weSIsIGNvbW1hbmQ9bGFtYmRhIGFkZHJlc3M9aW5mb1sid2FsbGV0Il06IGNvcHlfdG9fY2xpcGJvYXJkKGFkZHJlc3MpLCBib290c3R5bGU9ImluZm8tb3V0bGluZSIpCiAgICAgICAgY29weV9idXR0b24uZ3JpZChyb3c9cm93LCBjb2x1bW49Miwgc3RpY2t5PSJ3IiwgcGFkeT01LCBwYWR4PTUpCgogICAgICAgIHJvdyArPSAxCgogICAgIyBDcnlwdG9jdXJyZW5jeSBzZWxlY3Rpb24KICAgIGNyeXB0b19sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9IlNlbGVjdCBDcnlwdG9jdXJyZW5jeToiLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImluZm8iKQogICAgY3J5cHRvX2xhYmVsLmdyaWQocm93PXJvdywgY29sdW1uPTAsIHN0aWNreT0iZSIsIHBhZHk9NSkKCiAgICBjcnlwdG9fb3B0aW9ucyA9IFsiYml0Y29pbiIsICJldGhlcmV1bSIsICJ4cnAiLCAic2hpYmFfaW51Il0KICAgIHNlbGVjdGVkX2NyeXB0byA9IHRrLlN0cmluZ1ZhcigpCiAgICBzZWxlY3RlZF9jcnlwdG8uc2V0KGNyeXB0b19vcHRpb25zWzBdKSAgIyBEZWZhdWx0IHZhbHVlCgogICAgY3J5cHRvX2Ryb3Bkb3duID0gdHRrLkNvbWJvYm94KHdhbGxldF9mcmFtZSwgdGV4dHZhcmlhYmxlPXNlbGVjdGVkX2NyeXB0bywgdmFsdWVzPWNyeXB0b19vcHRpb25zLCBzdGF0ZT0icmVhZG9ubHkiKQogICAgY3J5cHRvX2Ryb3Bkb3duLmdyaWQocm93PXJvdywgY29sdW1uPTEsIHN0aWNreT0idyIsIHBhZHk9NSkKCiAgICByb3cgKz0gMQoKICAgIGdlbmVyYXRlX2J1dHRvbiA9IHR0ay5CdXR0b24od2FsbGV0X2ZyYW1lLCB0ZXh0PSJHZW5lcmF0ZSBOZXcgQWRkcmVzcyIsIGNvbW1hbmQ9bGFtYmRhOiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgc2VsZWN0ZWRfY3J5cHRvLmdldCgpKSwgYm9vdHN0eWxlPSJzdWNjZXNzLW91dGxpbmUiKQogICAgZ2VuZXJhdGVfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0yMCkKCiAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgZiJOZXcge2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gYWRkcmVzcyBnZW5lcmF0ZWQgYW5kIHNhdmVkLiIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCgogICAgcGluX3dpbmRvdyA9IHR0ay5XaW5kb3codGhlbWVuYW1lPSJkYXJrbHkiKQogICAgcGluX3dpbmRvdy50aXRsZSgiVVNCIFdhbGxldCAtIFBJTiBFbnRyeSIpCiAgICBwaW5fd2luZG93Lmdlb21ldHJ5KCI0MDB4MjAwIikKCiAgICBwaW5fbGFiZWwgPSB0dGsuTGFiZWwocGluX3dpbmRvdywgdGV4dD0iRW50ZXIgeW91ciBQSU46IiwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgIHBpbl9sYWJlbC5wYWNrKHBhZHk9MTApCgogICAgcGluX2VudHJ5ID0gdHRrLkVudHJ5KHBpbl93aW5kb3csIHNob3c9JyonLCBib290c3R5bGU9InByaW1hcnkiKQogICAgcGluX2VudHJ5LnBhY2socGFkeT0xMCkKCiAgICBpZiBwaW4gaXMgTm9uZToKICAgICAgICBwaW5fY29uZmlybV9sYWJlbCA9IHR0ay5MYWJlbChwaW5fd2luZG93LCB0ZXh0PSJDb25maXJtIHlvdXIgUElOOiIsIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICAgICAgcGluX2NvbmZpcm1fbGFiZWwucGFjayhwYWR5PTEwKQoKICAgICAgICBwaW5fY29uZmlybV9lbnRyeSA9IHR0ay5FbnRyeShwaW5fd2luZG93LCBzaG93PScqJywgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgICAgICBwaW5fY29uZmlybV9lbnRyeS5wYWNrKHBhZHk9MTApCgogICAgcGluX2VudHJ5LmJpbmQoIjxSZXR1cm4+Iiwgb25fcGluX2VudHJ5KQogICAgaWYgcGluIGlzIE5vbmU6CiAgICAgICAgcGluX2NvbmZpcm1fZW50cnkuYmluZCgiPFJldHVybj4iLCBvbl9waW5fZW50cnkpCgogICAgc3VibWl0X2J1dHRvbiA9IHR0ay5CdXR0b24ocGluX3dpbmRvdywgdGV4dD0iU3VibWl0IFBJTiIsIGNvbW1hbmQ9b25fcGluX2VudHJ5LCBib290c3R5bGU9InN1Y2Nlc3Mtb3V0bGluZSIpCiAgICBzdWJtaXRfYnV0dG9uLnBhY2socGFkeT0xMCkKCiAgICBwaW5fd2luZG93Lm1haW5sb29wKCkK",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAFIhAAAAAAAAAAAAAAAA8L8"
				],
				[
					359,
					1,
					"paste",
					null,
					"AgAAACogAAAAAAAA0CEAAAAAAAAAAAAA0CEAAAAAAADQIQAAAAAAAAsAAABwaW5fY29uZmlybQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAqIAAAAAAAADUgAAAAAAAAAAAAAAAA8L8"
				],
				[
					364,
					1,
					"right_delete",
					null,
					"AQAAAC0gAAAAAAAALSAAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAtIAAAAAAAAC0gAAAAAAAAAAAAAAAA8L8"
				],
				[
					365,
					1,
					"left_delete",
					null,
					"AQAAACogAAAAAAAAKiAAAAAAAAADAAAAICAg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAtIAAAAAAAAC0gAAAAAAAAAAAAAAAA8L8"
				],
				[
					374,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAsyAAAAAAAAAAAAAAsyAAAAAAAACzIAAAAAAAAMwhAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0dGtib290c3RyYXAuY29uc3RhbnRzIGltcG9ydCAqCmZyb20gdHRrYm9vdHN0cmFwLnN0eWxlIGltcG9ydCBCb290c3R5bGUKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGV0aF9hY2NvdW50IGltcG9ydCBBY2NvdW50CmZyb20gdGtpbnRlciBpbXBvcnQgbWVzc2FnZWJveCwgc2ltcGxlZGlhbG9nCgojIFBhdGggdG8gc3RvcmUgdGhlIGVuY3J5cHRlZCB3YWxsZXQgaW5mb3JtYXRpb24KV0FMTEVUX0ZJTEUgPSAid2FsbGV0X2luZm8uZW5jIgpQSU5fRklMRSA9ICJwaW4uZW5jIgoKIyBHZW5lcmF0ZSBvciBsb2FkIGVuY3J5cHRpb24ga2V5CmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCiMgRW5jcnlwdCBkYXRhCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCiMgRGVjcnlwdCBkYXRhCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCiMgTG9hZCBvciBjcmVhdGUgYSBuZXcgUElOCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgojIFNhdmUgYSBuZXcgUElOCmRlZiBzZXRfcGluKG5ld19waW4sIGtleSk6CiAgICBlbmNyeXB0ZWRfcGluID0gZW5jcnlwdChuZXdfcGluLCBrZXkpCiAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJ3YiIpIGFzIHBpbl9maWxlOgogICAgICAgIHBpbl9maWxlLndyaXRlKGVuY3J5cHRlZF9waW4pCgojIFZlcmlmeSBQSU4KZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKIyBDcmVhdGUgb3IgbG9hZCB3YWxsZXQgaW5mb3JtYXRpb24KZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IHdhbGxldF9maWxlLnJlYWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGRlY3J5cHQoZW5jcnlwdGVkX2RhdGEsIGtleSkpCiAgICBlbHNlOgogICAgICAgICMgRXhhbXBsZSB3YWxsZXQgaW5mb3JtYXRpb24gc3RydWN0dXJlCiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgImV0aGVyZXVtIjogeyJ3YWxsZXQiOiAiZXRoZXJldW1fd2FsbGV0X2FkZHJlc3MiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJ4cnAiOiB7IndhbGxldCI6ICJ4cnBfd2FsbGV0X2FkZHJlc3MiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCiMgU2F2ZSB3YWxsZXQgaW5mb3JtYXRpb24KZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzCiAgICBlbHNlOgogICAgICAgIHdhbGxldCA9IFdhbGxldC5jcmVhdGUoZidVU0JXYWxsZXRfe2NyeXB0b190eXBlfScpCiAgICAgICAga2V5ID0gd2FsbGV0Lm5ld19rZXkoKQogICAgICAgIHJldHVybiBrZXkuYWRkcmVzcwoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gcGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBwaW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgb3Blbl93YWxsZXRfd2luZG93KCkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBwaW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIHBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBvcGVuX3dhbGxldF93aW5kb3coKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgb3Blbl93YWxsZXRfd2luZG93KCk6CiAgICB3YWxsZXRfd2luZG93ID0gdGsuVG9wbGV2ZWwocGluX3dpbmRvdykKICAgIHdhbGxldF93aW5kb3cudGl0bGUoIlVTQiBXYWxsZXQgSW5mb3JtYXRpb24iKQogICAgd2FsbGV0X3dpbmRvdy5nZW9tZXRyeSgiNTAweDUwMCIpCgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKCiAgICAjIFdhbGxldCBJbmZvcm1hdGlvbiBGcmFtZQogICAgd2FsbGV0X2ZyYW1lID0gdHRrLkZyYW1lKHdhbGxldF93aW5kb3csIHBhZGRpbmc9KDIwLCAxMCkpCiAgICB3YWxsZXRfZnJhbWUucGFjayhmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgd2FsbGV0X2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iV2FsbGV0IEluZm9ybWF0aW9uIiwgZm9udD0oIkhlbHZldGljYSIsIDE2LCAiYm9sZCIpLCBib290c3R5bGU9InByaW1hcnkiKQogICAgd2FsbGV0X2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MTApCgogICAgIyBEaXNwbGF5aW5nIFdhbGxldCBJbmZvCiAgICByb3cgPSAxCiAgICBmb3IgY3J5cHRvLCBpbmZvIGluIHdhbGxldF9pbmZvLml0ZW1zKCk6CiAgICAgICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1mIntjcnlwdG8uY2FwaXRhbGl6ZSgpfSBBZGRyZXNzOiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICAgICAgY3J5cHRvX2xhYmVsLmdyaWQocm93PXJvdywgY29sdW1uPTAsIHN0aWNreT0iZSIsIHBhZHk9NSkKCiAgICAgICAgY3J5cHRvX3ZhbHVlID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1pbmZvWyJ3YWxsZXQiXSwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJkZWZhdWx0IikKICAgICAgICBjcnlwdG9fdmFsdWUuZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgICAgICBjb3B5X2J1dHRvbiA9IHR0ay5CdXR0b24od2FsbGV0X2ZyYW1lLCB0ZXh0PSJDb3B5IiwgY29tbWFuZD1sYW1iZGEgYWRkcmVzcz1pbmZvWyJ3YWxsZXQiXTogY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyksIGJvb3RzdHlsZT0iaW5mby1vdXRsaW5lIikKICAgICAgICBjb3B5X2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0yLCBzdGlja3k9InciLCBwYWR5PTUsIHBhZHg9NSkKCiAgICAgICAgcm93ICs9IDEKCiAgICAjIENyeXB0b2N1cnJlbmN5IHNlbGVjdGlvbgogICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iU2VsZWN0IENyeXB0b2N1cnJlbmN5OiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgIGNyeXB0b19vcHRpb25zID0gWyJiaXRjb2luIiwgImV0aGVyZXVtIiwgInhycCIsICJzaGliYV9pbnUiXQogICAgc2VsZWN0ZWRfY3J5cHRvID0gdGsuU3RyaW5nVmFyKCkKICAgIHNlbGVjdGVkX2NyeXB0by5zZXQoY3J5cHRvX29wdGlvbnNbMF0pICAjIERlZmF1bHQgdmFsdWUKCiAgICBjcnlwdG9fZHJvcGRvd24gPSB0dGsuQ29tYm9ib3god2FsbGV0X2ZyYW1lLCB0ZXh0dmFyaWFibGU9c2VsZWN0ZWRfY3J5cHRvLCB2YWx1ZXM9Y3J5cHRvX29wdGlvbnMsIHN0YXRlPSJyZWFkb25seSIpCiAgICBjcnlwdG9fZHJvcGRvd24uZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgIHJvdyArPSAxCgogICAgZ2VuZXJhdGVfYnV0dG9uID0gdHRrLkJ1dHRvbih3YWxsZXRfZnJhbWUsIHRleHQ9IkdlbmVyYXRlIE5ldyBBZGRyZXNzIiwgY29tbWFuZD1sYW1iZGE6IG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBzZWxlY3RlZF9jcnlwdG8uZ2V0KCkpLCBib290c3R5bGU9InN1Y2Nlc3Mtb3V0bGluZSIpCiAgICBnZW5lcmF0ZV9idXR0b24uZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgY29sdW1uc3Bhbj0zLCBwYWR5PTIwKQoKZGVmIGNvcHlfdG9fY2xpcGJvYXJkKGFkZHJlc3MpOgogICAgcGluX3dpbmRvdy5jbGlwYm9hcmRfY2xlYXIoKQogICAgcGluX3dpbmRvdy5jbGlwYm9hcmRfYXBwZW5kKGFkZHJlc3MpCiAgICBwaW5fd2luZG93LnVwZGF0ZSgpICAjIEtlZXAgdGhlIGNsaXBib2FyZCBkYXRhIGF2YWlsYWJsZQogICAgbWVzc2FnZWJveC5zaG93aW5mbygiQ29waWVkIiwgIkFkZHJlc3MgY29waWVkIHRvIGNsaXBib2FyZC4iKQoKZGVmIG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgbmV3X2FkZHJlc3MgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgVXBkYXRpbmcgdGhlIGRpc3BsYXkKICAgIGZvciB3aWRnZXQgaW4gd2FsbGV0X2ZyYW1lLndpbmZvX2NoaWxkcmVuKCk6CiAgICAgICAgd2lkZ2V0LmRlc3Ryb3koKQoKICAgIHdhbGxldF9sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9IldhbGxldCBJbmZvcm1hdGlvbiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxNiwgImJvbGQiKSwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgIHdhbGxldF9sYWJlbC5ncmlkKHJvdz0wLCBjb2x1bW49MCwgY29sdW1uc3Bhbj0zLCBwYWR5PTEwKQoKICAgIHJvdyA9IDEKICAgIGZvciBjcnlwdG8sIGluZm8gaW4gd2FsbGV0X2luZm8uaXRlbXMoKToKICAgICAgICBjcnlwdG9fbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PWYie2NyeXB0by5jYXBpdGFsaXplKCl9IEFkZHJlc3M6IiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJpbmZvIikKICAgICAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgICAgICBjcnlwdG9fdmFsdWUgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PWluZm9bIndhbGxldCJdLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImRlZmF1bHQiKQogICAgICAgIGNyeXB0b192YWx1ZS5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgICAgIGNvcHlfYnV0dG9uID0gdHRrLkJ1dHRvbih3YWxsZXRfZnJhbWUsIHRleHQ9IkNvcHkiLCBjb21tYW5kPWxhbWJkYSBhZGRyZXNzPWluZm9bIndhbGxldCJdOiBjb3B5X3RvX2NsaXBib2FyZChhZGRyZXNzKSwgYm9vdHN0eWxlPSJpbmZvLW91dGxpbmUiKQogICAgICAgIGNvcHlfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTIsIHN0aWNreT0idyIsIHBhZHk9NSwgcGFkeD01KQoKICAgICAgICByb3cgKz0gMQoKICAgICMgQ3J5cHRvY3VycmVuY3kgc2VsZWN0aW9uCiAgICBjcnlwdG9fbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PSJTZWxlY3QgQ3J5cHRvY3VycmVuY3k6IiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJpbmZvIikKICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUpCgogICAgY3J5cHRvX29wdGlvbnMgPSBbImJpdGNvaW4iLCAiZXRoZXJldW0iLCAieHJwIiwgInNoaWJhX2ludSJdCiAgICBzZWxlY3RlZF9jcnlwdG8gPSB0ay5TdHJpbmdWYXIoKQogICAgc2VsZWN0ZWRfY3J5cHRvLnNldChjcnlwdG9fb3B0aW9uc1swXSkgICMgRGVmYXVsdCB2YWx1ZQoKICAgIGNyeXB0b19kcm9wZG93biA9IHR0ay5Db21ib2JveCh3YWxsZXRfZnJhbWUsIHRleHR2YXJpYWJsZT1zZWxlY3RlZF9jcnlwdG8sIHZhbHVlcz1jcnlwdG9fb3B0aW9ucywgc3RhdGU9InJlYWRvbmx5IikKICAgIGNyeXB0b19kcm9wZG93bi5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgcm93ICs9IDEKCiAgICBnZW5lcmF0ZV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iR2VuZXJhdGUgTmV3IEFkZHJlc3MiLCBjb21tYW5kPWxhbWJkYTogb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIHNlbGVjdGVkX2NyeXB0by5nZXQoKSksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIGdlbmVyYXRlX2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MjApCgogICAgbWVzc2FnZWJveC5zaG93aW5mbygiU3VjY2VzcyIsIGYiTmV3IHtjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9IGFkZHJlc3MgZ2VuZXJhdGVkIGFuZCBzYXZlZC4iKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGtleSA9IGxvYWRfa2V5KCkKICAgIHBpbiA9IGdldF9waW4oa2V5KQoKICAgIHBpbl93aW5kb3cgPSB0dGsuV2luZG93KHRoZW1lbmFtZT0iZGFya2x5IikKICAgIHBpbl93aW5kb3cudGl0bGUoIlVTQiBXYWxsZXQgLSBQSU4gRW50cnkiKQogICAgcGluX3dpbmRvdy5nZW9tZXRyeSgiNDAweDIwMCIpCgogICAgcGluX2xhYmVsID0gdHRrLkxhYmVsKHBpbl93aW5kb3csIHRleHQ9IkVudGVyIHlvdXIgUElOOiIsIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICBwaW5fbGFiZWwucGFjayhwYWR5PTEwKQoKICAgIHBpbl9lbnRyeSA9IHR0ay5FbnRyeShwaW5fd2luZG93LCBzaG93PScqJywgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgIHBpbl9lbnRyeS5wYWNrKHBhZHk9MTApCgogICAgaWYgcGluIGlzIE5vbmU6CiAgICAgICAgcGluX2NvbmZpcm1fbGFiZWwgPSB0dGsuTGFiZWwocGluX3dpbmRvdywgdGV4dD0iQ29uZmlybSB5b3VyIFBJTjoiLCBib290c3R5bGU9InByaW1hcnkiKQogICAgICAgIHBpbl9jb25maXJtX2xhYmVsLnBhY2socGFkeT0xMCkKCiAgICBwaW5fY29uZmlybV9lbnRyeSA9IHR0ay5FbnRyeShwaW5fd2luZG93LCBzaG93PScqJywgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgIHBpbl9jb25maXJtX2VudHJ5LnBhY2socGFkeT0xMCkKCnBpbl9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKaWYgcGluIGlzIE5vbmU6CiAgICBwaW5fY29uZmlybV9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKCnN1Ym1pdF9idXR0b24gPSB0dGsuQnV0dG9uKHBpbl93aW5kb3csIHRleHQ9IlN1Ym1pdCBQSU4iLCBjb21tYW5kPW9uX3Bpbl9lbnRyeSwgYm9vdHN0eWxlPSJzdWNjZXNzLW91dGxpbmUiKQpzdWJtaXRfYnV0dG9uLnBhY2socGFkeT0xMCkKCnBpbl93aW5kb3cubWFpbmxvb3AoKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAMwhAAAAAAAAAAAAAAAA8L8"
				],
				[
					383,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"BAAAALMgAAAAAAAAtCAAAAAAAAAAAAAAtCAAAAAAAAC4IAAAAAAAAAAAAAC0IAAAAAAAALQgAAAAAAAABAAAACAgICC0IAAAAAAAALwgAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACzIAAAAAAAALMgAAAAAAAAAAAAAAAA8L8"
				],
				[
					384,
					1,
					"left_delete",
					null,
					"AQAAALggAAAAAAAAuCAAAAAAAAAEAAAAICAgIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC8IAAAAAAAALwgAAAAAAAAAAAAAAAA8L8"
				],
				[
					385,
					1,
					"paste",
					null,
					"AQAAALggAAAAAAAAOyUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC4IAAAAAAAALggAAAAAAAAAAAAAAAA8L8"
				],
				[
					408,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAqhAAAAAAAAAAAAAAqhAAAAAAAACqEAAAAAAAADslAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0dGtib290c3RyYXAuY29uc3RhbnRzIGltcG9ydCAqCmZyb20gdHRrYm9vdHN0cmFwLnN0eWxlIGltcG9ydCBCb290c3R5bGUKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGV0aF9hY2NvdW50IGltcG9ydCBBY2NvdW50CmZyb20gdGtpbnRlciBpbXBvcnQgbWVzc2FnZWJveCwgc2ltcGxlZGlhbG9nCgojIFBhdGggdG8gc3RvcmUgdGhlIGVuY3J5cHRlZCB3YWxsZXQgaW5mb3JtYXRpb24KV0FMTEVUX0ZJTEUgPSAid2FsbGV0X2luZm8uZW5jIgpQSU5fRklMRSA9ICJwaW4uZW5jIgoKIyBHZW5lcmF0ZSBvciBsb2FkIGVuY3J5cHRpb24ga2V5CmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCiMgRW5jcnlwdCBkYXRhCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCiMgRGVjcnlwdCBkYXRhCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCiMgTG9hZCBvciBjcmVhdGUgYSBuZXcgUElOCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgojIFNhdmUgYSBuZXcgUElOCmRlZiBzZXRfcGluKG5ld19waW4sIGtleSk6CiAgICBlbmNyeXB0ZWRfcGluID0gZW5jcnlwdChuZXdfcGluLCBrZXkpCiAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJ3YiIpIGFzIHBpbl9maWxlOgogICAgICAgIHBpbl9maWxlLndyaXRlKGVuY3J5cHRlZF9waW4pCgojIFZlcmlmeSBQSU4KZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKIyBDcmVhdGUgb3IgbG9hZCB3YWxsZXQgaW5mb3JtYXRpb24KZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IHdhbGxldF9maWxlLnJlYWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGRlY3J5cHQoZW5jcnlwdGVkX2RhdGEsIGtleSkpCiAgICBlbHNlOgogICAgICAgICMgRXhhbXBsZSB3YWxsZXQgaW5mb3JtYXRpb24gc3RydWN0dXJlCiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJiaXRjb2luX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJldGhlcmV1bV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJ4cnBfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJzaGliYV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCiMgU2F2ZSB3YWxsZXQgaW5mb3JtYXRpb24KZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gcGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBwaW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgb3Blbl93YWxsZXRfd2luZG93KCkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBwaW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIHBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBvcGVuX3dhbGxldF93aW5kb3coKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgb3Blbl93YWxsZXRfd2luZG93KCk6CiAgICB3YWxsZXRfd2luZG93ID0gdGsuVG9wbGV2ZWwocGluX3dpbmRvdykKICAgIHdhbGxldF93aW5kb3cudGl0bGUoIlVTQiBXYWxsZXQgSW5mb3JtYXRpb24iKQogICAgd2FsbGV0X3dpbmRvdy5nZW9tZXRyeSgiNTAweDUwMCIpCgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKCiAgICAjIFdhbGxldCBJbmZvcm1hdGlvbiBGcmFtZQogICAgd2FsbGV0X2ZyYW1lID0gdHRrLkZyYW1lKHdhbGxldF93aW5kb3csIHBhZGRpbmc9KDIwLCAxMCkpCiAgICB3YWxsZXRfZnJhbWUucGFjayhmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgd2FsbGV0X2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iV2FsbGV0IEluZm9ybWF0aW9uIiwgZm9udD0oIkhlbHZldGljYSIsIDE2LCAiYm9sZCIpLCBib290c3R5bGU9InByaW1hcnkiKQogICAgd2FsbGV0X2xhYmVsLmdyaWQocm93PTAsIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MTApCgogICAgIyBEaXNwbGF5aW5nIFdhbGxldCBJbmZvCiAgICByb3cgPSAxCiAgICBmb3IgY3J5cHRvLCBpbmZvIGluIHdhbGxldF9pbmZvLml0ZW1zKCk6CiAgICAgICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1mIntjcnlwdG8uY2FwaXRhbGl6ZSgpfSBBZGRyZXNzOiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICAgICAgY3J5cHRvX2xhYmVsLmdyaWQocm93PXJvdywgY29sdW1uPTAsIHN0aWNreT0iZSIsIHBhZHk9NSkKCiAgICAgICAgY3J5cHRvX3ZhbHVlID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1pbmZvWyJ3YWxsZXQiXSwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJkZWZhdWx0IikKICAgICAgICBjcnlwdG9fdmFsdWUuZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgICAgICBjb3B5X2J1dHRvbiA9IHR0ay5CdXR0b24od2FsbGV0X2ZyYW1lLCB0ZXh0PSJDb3B5IiwgY29tbWFuZD1sYW1iZGEgYWRkcmVzcz1pbmZvWyJ3YWxsZXQiXTogY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyksIGJvb3RzdHlsZT0iaW5mby1vdXRsaW5lIikKICAgICAgICBjb3B5X2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0yLCBzdGlja3k9InciLCBwYWR5PTUsIHBhZHg9NSkKCiAgICAgICAgcm93ICs9IDEKCiAgICAjIENyeXB0b2N1cnJlbmN5IHNlbGVjdGlvbgogICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iU2VsZWN0IENyeXB0b2N1cnJlbmN5OiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgIGNyeXB0b19vcHRpb25zID0gWyJiaXRjb2luIiwgImV0aGVyZXVtIiwgInhycCIsICJzaGliYV9pbnUiXQogICAgc2VsZWN0ZWRfY3J5cHRvID0gdGsuU3RyaW5nVmFyKCkKICAgIHNlbGVjdGVkX2NyeXB0by5zZXQoY3J5cHRvX29wdGlvbnNbMF0pICAjIERlZmF1bHQgdmFsdWUKCiAgICBjcnlwdG9fZHJvcGRvd24gPSB0dGsuQ29tYm9ib3god2FsbGV0X2ZyYW1lLCB0ZXh0dmFyaWFibGU9c2VsZWN0ZWRfY3J5cHRvLCB2YWx1ZXM9Y3J5cHRvX29wdGlvbnMsIHN0YXRlPSJyZWFkb25seSIpCiAgICBjcnlwdG9fZHJvcGRvd24uZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgIHZpZXdfYnV0dG9uID0gdHRrLkJ1dHRvbih3YWxsZXRfZnJhbWUsIHRleHQ9IlZpZXcgS2V5cyIsIGNvbW1hbmQ9bGFtYmRhOiB2aWV3X2tleXMoc2VsZWN0ZWRfY3J5cHRvLmdldCgpKSwgYm9vdHN0eWxlPSJpbmZvLW91dGxpbmUiKQogICAgdmlld19idXR0b24uZ3JpZChyb3c9cm93LCBjb2x1bW49Miwgc3RpY2t5PSJ3IiwgcGFkeT01LCBwYWR4PTUpCgogICAgcm93ICs9IDEKCiAgICBnZW5lcmF0ZV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iR2VuZXJhdGUgTmV3IEFkZHJlc3MiLCBjb21tYW5kPWxhbWJkYTogb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIHNlbGVjdGVkX2NyeXB0by5nZXQoKSksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIGdlbmVyYXRlX2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBjb2x1bW5zcGFuPTMsIHBhZHk9MjApCgpkZWYgY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyk6CiAgICBwaW5fd2luZG93LmNsaXBib2FyZF9jbGVhcigpCiAgICBwaW5fd2luZG93LmNsaXBib2FyZF9hcHBlbmQoYWRkcmVzcykKICAgIHBpbl93aW5kb3cudXBkYXRlKCkgICMgS2VlcCB0aGUgY2xpcGJvYXJkIGRhdGEgYXZhaWxhYmxlCiAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJDb3BpZWQiLCAiQWRkcmVzcyBjb3BpZWQgdG8gY2xpcGJvYXJkLiIpCgpkZWYgdmlld19rZXlzKGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBpZiBjcnlwdG9fdHlwZSBpbiB3YWxsZXRfaW5mbzoKICAgICAgICBwdWJfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXQogICAgICAgIHByaXZfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdCiAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbyhmIntjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9IEtleXMiLCBmIlB1YmxpYyBLZXk6IHtwdWJfa2V5fVxuUHJpdmF0ZSBLZXk6IHtwcml2X2tleX0iKQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCBmIk5vIGtleXMgZm91bmQgZm9yIHtjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9LiIpCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcywgcHJpdmF0ZV9rZXkgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdID0gcHJpdmF0ZV9rZXkKICAgIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSkKCiAgICAjIFVwZGF0aW5nIHRoZSBkaXNwbGF5CiAgICBmb3Igd2lkZ2V0IGluIHdhbGxldF9mcmFtZS53aW5mb19jaGlsZHJlbigpOgogICAgICAgIHdpZGdldC5kZXN0cm95KCkKCiAgICB3YWxsZXRfbGFiZWwgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PSJXYWxsZXQgSW5mb3JtYXRpb24iLCBmb250PSgiSGVsdmV0aWNhIiwgMTYsICJib2xkIiksIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICB3YWxsZXRfbGFiZWwuZ3JpZChyb3c9MCwgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0xMCkKCiAgICByb3cgPSAxCiAgICBmb3IgY3J5cHRvLCBpbmZvIGluIHdhbGxldF9pbmZvLml0ZW1zKCk6CiAgICAgICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1mIntjcnlwdG8uY2FwaXRhbGl6ZSgpfSBBZGRyZXNzOiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICAgICAgY3J5cHRvX2xhYmVsLmdyaWQocm93PXJvdywgY29sdW1uPTAsIHN0aWNreT0iZSIsIHBhZHk9NSkKCiAgICAgICAgY3J5cHRvX3ZhbHVlID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1pbmZvWyJ3YWxsZXQiXSwgZm9udD0oIkhlbHZldGljYSIsIDEyKSwgYm9vdHN0eWxlPSJkZWZhdWx0IikKICAgICAgICBjcnlwdG9fdmFsdWUuZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgICAgICBjb3B5X2J1dHRvbiA9IHR0ay5CdXR0b24od2FsbGV0X2ZyYW1lLCB0ZXh0PSJDb3B5IiwgY29tbWFuZD1sYW1iZGEgYWRkcmVzcz1pbmZvWyJ3YWxsZXQiXTogY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyksIGJvb3RzdHlsZT0iaW5mby1vdXRsaW5lIikKICAgICAgICBjb3B5X2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0yLCBzdGlja3k9InciLCBwYWR5PTUsIHBhZHg9NSkKCiAgICAgICAgcm93ICs9IDEKCiAgICAjIENyeXB0b2N1cnJlbmN5IHNlbGVjdGlvbgogICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD0iU2VsZWN0IENyeXB0b2N1cnJlbmN5OiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICBjcnlwdG9fbGFiZWwuZ3JpZChyb3c9cm93LCBjb2x1bW49MCwgc3RpY2t5PSJlIiwgcGFkeT01KQoKICAgIGNyeXB0b19kcm9wZG93biA9IHR0ay5Db21ib2JveCh3YWxsZXRfZnJhbWUsIHRleHR2YXJpYWJsZT1zZWxlY3RlZF9jcnlwdG8sIHZhbHVlcz1jcnlwdG9fb3B0aW9ucywgc3RhdGU9InJlYWRvbmx5IikKICAgIGNyeXB0b19kcm9wZG93bi5ncmlkKHJvdz1yb3csIGNvbHVtbj0xLCBzdGlja3k9InciLCBwYWR5PTUpCgogICAgdmlld19idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iVmlldyBLZXlzIiwgY29tbWFuZD1sYW1iZGE6IHZpZXdfa2V5cyhzZWxlY3RlZF9jcnlwdG8uZ2V0KCkpLCBib290c3R5bGU9ImluZm8tb3V0bGluZSIpCiAgICB2aWV3X2J1dHRvbi5ncmlkKHJvdz1yb3csIGNvbHVtbj0yLCBzdGlja3k9InciLCBwYWR5PTUsIHBhZHg9NSkKCiAgICByb3cgKz0gMQoKICAgIGdlbmVyYXRlX2J1dHRvbiA9IHR0ay5CdXR0b24od2FsbGV0X2ZyYW1lLCB0ZXh0PSJHZW5lcmF0ZSBOZXcgQWRkcmVzcyIsIGNvbW1hbmQ9bGFtYmRhCiAgICAgICAgZ2VuZXJhdGVfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0yMCkKCiAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgZiJOZXcge2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gYWRkcmVzcyBnZW5lcmF0ZWQgYW5kIHNhdmVkLiIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCiAgICBwaW5fd2luZG93ID0gdHRrLldpbmRvdyh0aGVtZW5hbWU9ImRhcmtseSIpCiAgICBwaW5fd2luZG93LnRpdGxlKCJVU0IgV2FsbGV0IC0gUElOIEVudHJ5IikKICAgIHBpbl93aW5kb3cuZ2VvbWV0cnkoIjQwMHgyMDAiKQoKICAgIHBpbl9sYWJlbCA9IHR0ay5MYWJlbChwaW5fd2luZG93LCB0ZXh0PSJFbnRlciB5b3VyIFBJTjoiLCBib290c3R5bGU9InByaW1hcnkiKQogICAgcGluX2xhYmVsLnBhY2socGFkeT0xMCkKCiAgICBwaW5fZW50cnkgPSB0dGsuRW50cnkocGluX3dpbmRvdywgc2hvdz0nKicsIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICBwaW5fZW50cnkucGFjayhwYWR5PTEwKQoKICAgIGlmIHBpbiBpcyBOb25lOgogICAgICAgIHBpbl9jb25maXJtX2xhYmVsID0gdHRrLkxhYmVsKHBpbl93aW5kb3csIHRleHQ9IkNvbmZpcm0geW91ciBQSU46IiwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgICAgICBwaW5fY29uZmlybV9sYWJlbC5wYWNrKHBhZHk9MTApCgogICAgICAgIHBpbl9jb25maXJtX2VudHJ5ID0gdHRrLkVudHJ5KHBpbl93aW5kb3csIHNob3c9JyonLCBib290c3R5bGU9InByaW1hcnkiKQogICAgICAgIHBpbl9jb25maXJtX2VudHJ5LnBhY2socGFkeT0xMCkKCiAgICBwaW5fZW50cnkuYmluZCgiPFJldHVybj4iLCBvbl9waW5fZW50cnkpCiAgICBpZiBwaW4gaXMgTm9uZToKICAgICAgICBwaW5fY29uZmlybV9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKCiAgICBzdWJtaXRfYnV0dG9uID0gdHRrLkJ1dHRvbihwaW5fd2luZG93LCB0ZXh0PSJTdWJtaXQgUElOIiwgY29tbWFuZD1vbl9waW5fZW50cnksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgIHN1Ym1pdF9idXR0b24ucGFjayhwYWR5PTEwKQoKICAgIHBpbl93aW5kb3cubWFpbmxvb3AoKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAADslAAAAAAAAAAAAAAAA8L8"
				],
				[
					417,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAtxAAAAAAAAAAAAAAtxAAAAAAAAC3EAAAAAAAAKoQAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGd1aSBpbXBvcnQgV2FsbGV0R1VJCgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImJpdGNvaW5fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImV0aGVyZXVtX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInhycF9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInNoaWJhX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gZ3VpLnBpbl9lbnRyeS5nZXQoKQogICAgaWYgc3RvcmVkX3BpbjoKICAgICAgICBpZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgICAgICAgICAgcGluX3dpbmRvdy53aXRoZHJhdygpCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICBlbHNlOgogICAgICAgIGNvbmZpcm1fcGluID0gZ3VpLnBpbl9jb25maXJtX2VudHJ5LmdldCgpCiAgICAgICAgaWYgZW50ZXJlZF9waW4gPT0gY29uZmlybV9waW46CiAgICAgICAgICAgIHNldF9waW4oZW50ZXJlZF9waW4sIGtleSkKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygiU3VjY2VzcyIsICJOZXcgUElOIHNldCBzdWNjZXNzZnVsbHkuIikKICAgICAgICAgICAgcGluX3dpbmRvdy53aXRoZHJhdygpCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiB2aWV3X2tleXMoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIGlmIGNyeXB0b190eXBlIGluIHdhbGxldF9pbmZvOgogICAgICAgIHB1Yl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdCiAgICAgICAgcHJpdl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0KICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKGYie2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gS2V5cyIsIGYiUHVibGljIEtleToge3B1Yl9rZXl9XG5Qcml2YXRlIEtleToge3ByaXZfa2V5fSIpCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiTm8ga2V5cyBmb3VuZCBmb3Ige2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0uIikKCmRlZiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIG5ld19hZGRyZXNzLCBwcml2YXRlX2tleSA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0gPSBwcml2YXRlX2tleQogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgUmVmcmVzaCB3YWxsZXQgd2luZG93CiAgICBndWkub3Blbl93YWxsZXRfd2luZG93KHdhbGxldF9pbmZvLCBrZXkpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCiAgICAKICAgIHBpbl93aW5kb3cgPSB0dGsuV2luZG93KHRoZW1lbmFtZT0iZGFya2x5IikKICAgIGd1aSA9IFdhbGxldEdVSShwaW5fd2luZG93LCBvbl9nZW5lcmF0ZV9hZGRyZXNzLCB2aWV3X2tleXMsIFdhbGxldEdVSS5jb3B5X3RvX2NsaXBib2FyZCkKICAgIGd1aS5zaG93X3Bpbl93aW5kb3cob25fcGluX2VudHJ5KQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAKoQAAAAAAAAAAAAAAAA8L8"
				],
				[
					424,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAA+A8AAAAAAAAAAAAA+A8AAAAAAAD4DwAAAAAAALcQAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGd1aSBpbXBvcnQgV2FsbGV0R1VJCgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImJpdGNvaW5fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImV0aGVyZXVtX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInhycF9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInNoaWJhX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gZ3VpLnBpbl9lbnRyeS5nZXQoKQogICAgaWYgc3RvcmVkX3BpbjoKICAgICAgICBpZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgICAgICAgICAgZ3VpLnBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiUElOcyBkbyBub3QgbWF0Y2guIFRyeSBhZ2Fpbi4iKQoKZGVmIHZpZXdfa2V5cyhjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgaWYgY3J5cHRvX3R5cGUgaW4gd2FsbGV0X2luZm86CiAgICAgICAgcHViX2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0KICAgICAgICBwcml2X2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oZiJ7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfSBLZXlzIiwgZiJQdWJsaWMgS2V5OiB7cHViX2tleX1cblByaXZhdGUgS2V5OiB7cHJpdl9rZXl9IikKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgZiJObyBrZXlzIGZvdW5kIGZvciB7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfS4iKQoKZGVmIG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgbmV3X2FkZHJlc3MsIHByaXZhdGVfa2V5ID0gZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdID0gbmV3X2FkZHJlc3MKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXSA9IHByaXZhdGVfa2V5CiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBSZWZyZXNoIHdhbGxldCB3aW5kb3cKICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cod2FsbGV0X2luZm8sIGtleSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBrZXkgPSBsb2FkX2tleSgpCiAgICBwaW4gPSBnZXRfcGluKGtleSkKICAgIAogICAgcGluX3dpbmRvdyA9IHR0ay5XaW5kb3codGhlbWVuYW1lPSJkYXJrbHkiKQogICAgZ3VpID0gV2FsbGV0R1VJKHBpbl93aW5kb3csIG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikK",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAALcQAAAAAAAAAAAAAAAA8L8"
				],
				[
					431,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAuBAAAAAAAAAAAAAAuBAAAAAAAAC4EAAAAAAAAPgPAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGd1aSBpbXBvcnQgV2FsbGV0R1VJCgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImJpdGNvaW5fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImV0aGVyZXVtX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInhycF9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInNoaWJhX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gZ3VpLnBpbl9lbnRyeS5nZXQoKQogICAgaWYgc3RvcmVkX3BpbjoKICAgICAgICBpZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgICAgICAgICAgZ3VpLnBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiUElOcyBkbyBub3QgbWF0Y2guIFRyeSBhZ2Fpbi4iKQoKZGVmIHZpZXdfa2V5cyhjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgaWYgY3J5cHRvX3R5cGUgaW4gd2FsbGV0X2luZm86CiAgICAgICAgcHViX2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0KICAgICAgICBwcml2X2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oZiJ7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfSBLZXlzIiwgZiJQdWJsaWMgS2V5OiB7cHViX2tleX1cblByaXZhdGUgS2V5OiB7cHJpdl9rZXl9IikKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgZiJObyBrZXlzIGZvdW5kIGZvciB7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfS4iKQoKZGVmIG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgbmV3X2FkZHJlc3MsIHByaXZhdGVfa2V5ID0gZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdID0gbmV3X2FkZHJlc3MKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXSA9IHByaXZhdGVfa2V5CiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBSZWZyZXNoIHdhbGxldCB3aW5kb3cKICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cod2FsbGV0X2luZm8sIGtleSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBrZXkgPSBsb2FkX2tleSgpCiAgICBwaW4gPSBnZXRfcGluKGtleQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAPgPAAAAAAAAAAAAAAAA8L8"
				],
				[
					440,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAtxAAAAAAAAAAAAAAtxAAAAAAAAC3EAAAAAAAALgQAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGd1aSBpbXBvcnQgV2FsbGV0R1VJCgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZSk6CiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gd2FsbGV0X2ZpbGUucmVhZCgpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSwga2V5KSkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJiaXRjb2luX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJldGhlcmV1bV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJ4cnBfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJzaGliYV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCmRlZiBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpOgogICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAid2IiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IGVuY3J5cHQoanNvbi5kdW1wcyh3YWxsZXRfaW5mbyksIGtleSkKICAgICAgICB3YWxsZXRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKCmRlZiBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSk6CiAgICBpZiBjcnlwdG9fdHlwZSA9PSAiZXRoZXJldW0iOgogICAgICAgIGFjY291bnQgPSBBY2NvdW50LmNyZWF0ZSgpCiAgICAgICAgcmV0dXJuIGFjY291bnQuYWRkcmVzcywgYWNjb3VudC5rZXkuaGV4KCkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0ID0gV2FsbGV0LmNyZWF0ZShmJ1VTQldhbGxldF97Y3J5cHRvX3R5cGV9JykKICAgICAgICBrZXkgPSB3YWxsZXQubmV3X2tleSgpCiAgICAgICAgcmV0dXJuIGtleS5hZGRyZXNzLCBrZXkucHJpdmF0ZV9oZXgKCmRlZiBvbl9waW5fZW50cnkoZXZlbnQ9Tm9uZSk6CiAgICBzdG9yZWRfcGluID0gZ2V0X3BpbihrZXkpCiAgICBlbnRlcmVkX3BpbiA9IGd1aS5waW5fZW50cnkuZ2V0KCkKICAgIGlmIHN0b3JlZF9waW46CiAgICAgICAgaWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBndWkucGluX2NvbmZpcm1fZW50cnkuZ2V0KCkKICAgICAgICBpZiBlbnRlcmVkX3BpbiA9PSBjb25maXJtX3BpbjoKICAgICAgICAgICAgc2V0X3BpbihlbnRlcmVkX3Bpbiwga2V5KQogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgIk5ldyBQSU4gc2V0IHN1Y2Nlc3NmdWxseS4iKQogICAgICAgICAgICBndWkucGluX3dpbmRvdy53aXRoZHJhdygpCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiB2aWV3X2tleXMoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIGlmIGNyeXB0b190eXBlIGluIHdhbGxldF9pbmZvOgogICAgICAgIHB1Yl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdCiAgICAgICAgcHJpdl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0KICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKGYie2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gS2V5cyIsIGYiUHVibGljIEtleToge3B1Yl9rZXl9XG5Qcml2YXRlIEtleToge3ByaXZfa2V5fSIpCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiTm8ga2V5cyBmb3VuZCBmb3Ige2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0uIikKCmRlZiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIG5ld19hZGRyZXNzLCBwcml2YXRlX2tleSA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0gPSBwcml2YXRlX2tleQogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgUmVmcmVzaCB3YWxsZXQgd2luZG93CiAgICBndWkub3Blbl93YWxsZXRfd2luZG93KHdhbGxldF9pbmZvLCBrZXkpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCiAgICAKICAgIHBpbl93aW5kb3cgPSB0dGsuV2luZG93KHRoZW1lbmFtZT0iZGFya2x5IikKICAgIGd1aSA9IFdhbGxldEdVSShwaW5fd2luZG93LCBvbl9nZW5lcmF0ZV9hZGRyZXNzLCB2aWV3X2tleXMsIFdhbGxldEdVSS5jb3B5X3RvX2NsaXBib2FyZCkKICAgIGd1aS5zaG93X3Bpbl93aW5kb3cob25fcGluX2VudHJ5LCBwaW4pCg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAALgQAAAAAAAAAAAAAAAA8L8"
				],
				[
					453,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAArRAAAAAAAAAAAAAArRAAAAAAAACtEAAAAAAAALcQAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldApmcm9tIGd1aSBpbXBvcnQgV2FsbGV0R1VJCgpXQUxMRVRfRklMRSA9ICJ3YWxsZXRfaW5mby5lbmMiClBJTl9GSUxFID0gInBpbi5lbmMiCgpkZWYgbG9hZF9rZXkoKToKICAgIGlmIG9zLnBhdGguZXhpc3RzKCJzZWNyZXQua2V5Iik6CiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgInJiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIHJldHVybiBrZXlfZmlsZS5yZWFkKCkKICAgIGVsc2U6CiAgICAgICAga2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCiAgICAgICAgd2l0aCBvcGVuKCJzZWNyZXQua2V5IiwgIndiIikgYXMga2V5X2ZpbGU6CiAgICAgICAgICAgIGtleV9maWxlLndyaXRlKGtleSkKICAgICAgICByZXR1cm4ga2V5CgpkZWYgZW5jcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5lbmNyeXB0KGRhdGEuZW5jb2RlKCkpCgpkZWYgZGVjcnlwdChkYXRhLCBrZXkpOgogICAgZiA9IEZlcm5ldChrZXkpCiAgICByZXR1cm4gZi5kZWNyeXB0KGRhdGEpLmRlY29kZSgpCgpkZWYgZ2V0X3BpbihrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoUElOX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihQSU5fRklMRSwgInJiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9waW4gPSBwaW5fZmlsZS5yZWFkKCkKICAgICAgICBwaW4gPSBkZWNyeXB0KGVuY3J5cHRlZF9waW4sIGtleSkKICAgIGVsc2U6CiAgICAgICAgcGluID0gTm9uZQogICAgcmV0dXJuIHBpbgoKZGVmIHNldF9waW4obmV3X3Bpbiwga2V5KToKICAgIGVuY3J5cHRlZF9waW4gPSBlbmNyeXB0KG5ld19waW4sIGtleSkKICAgIHdpdGggb3BlbihQSU5fRklMRSwgIndiIikgYXMgcGluX2ZpbGU6CiAgICAgICAgcGluX2ZpbGUud3JpdGUoZW5jcnlwdGVkX3BpbikKCmRlZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgIGlmIGVudGVyZWRfcGluID09IHN0b3JlZF9waW46CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIkluY29ycmVjdCBQSU4uIikKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBsb2FkX3dhbGxldF9pbmZvKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhXQUxMRVRfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAicmIiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImJpdGNvaW5fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImV0aGVyZXVtX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInhycF9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInNoaWJhX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gZ3VpLnBpbl9lbnRyeS5nZXQoKQogICAgaWYgc3RvcmVkX3BpbjoKICAgICAgICBpZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgICAgICAgICAgZ3VpLnBpbl93aW5kb3cud2l0aGRyYXcoKQogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LndpdGhkcmF3KCkKICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiUElOcyBkbyBub3QgbWF0Y2guIFRyeSBhZ2Fpbi4iKQoKZGVmIHZpZXdfa2V5cyhjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgaWYgY3J5cHRvX3R5cGUgaW4gd2FsbGV0X2luZm86CiAgICAgICAgcHViX2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0KICAgICAgICBwcml2X2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oZiJ7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfSBLZXlzIiwgZiJQdWJsaWMgS2V5OiB7cHViX2tleX1cblByaXZhdGUgS2V5OiB7cHJpdl9rZXl9IikKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgZiJObyBrZXlzIGZvdW5kIGZvciB7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfS4iKQoKZGVmIG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgbmV3X2FkZHJlc3MsIHByaXZhdGVfa2V5ID0gZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdID0gbmV3X2FkZHJlc3MKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXSA9IHByaXZhdGVfa2V5CiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBSZWZyZXNoIHdhbGxldCB3aW5kb3cKICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cod2FsbGV0X2luZm8sIGtleSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBrZXkgPSBsb2FkX2tleSgpCiAgICBwaW4gPSBnZXRfcGluKGtleSkKICAgIAogICAgcGluX3dpbmRvdyA9IHR0ay5XaW5kb3codGhlbWVuYW1lPSJkYXJrbHkiKQogICAgZ3VpID0gV2FsbGV0R1VJKHBpbl93aW5kb3csIG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikK",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAALcQAAAAAAAAAAAAAAAA8L8"
				],
				[
					466,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAASQ8AAAAAAAAAAAAASQ8AAAAAAABJDwAAAAAAAK0QAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKZnJvbSBldGhfYWNjb3VudCBpbXBvcnQgQWNjb3VudApmcm9tIGJpdGNvaW5saWIud2FsbGV0cyBpbXBvcnQgV2FsbGV0CmZyb20gZ3VpIGltcG9ydCBXYWxsZXRHVUkKCldBTExFVF9GSUxFID0gIndhbGxldF9pbmZvLmVuYyIKUElOX0ZJTEUgPSAicGluLmVuYyIKCmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgpkZWYgc2V0X3BpbihuZXdfcGluLCBrZXkpOgogICAgZW5jcnlwdGVkX3BpbiA9IGVuY3J5cHQobmV3X3Bpbiwga2V5KQogICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAid2IiKSBhcyBwaW5fZmlsZToKICAgICAgICBwaW5fZmlsZS53cml0ZShlbmNyeXB0ZWRfcGluKQoKZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IHdhbGxldF9maWxlLnJlYWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGRlY3J5cHQoZW5jcnlwdGVkX2RhdGEsIGtleSkpCiAgICBlbHNlOgogICAgICAgIHdhbGxldF9pbmZvID0gewogICAgICAgICAgICAiYml0Y29pbiI6IHsid2FsbGV0IjogImJpdGNvaW5fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiYml0Y29pbl9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgImV0aGVyZXVtIjogeyJ3YWxsZXQiOiAiZXRoZXJldW1fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiZXRoZXJldW1fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJ4cnAiOiB7IndhbGxldCI6ICJ4cnBfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAieHJwX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAic2hpYmFfaW51IjogeyJ3YWxsZXQiOiAic2hpYmFfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAic2hpYmFfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdhbGxldF9pbmZvCgpkZWYgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KToKICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgIndiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSBlbmNyeXB0KGpzb24uZHVtcHMod2FsbGV0X2luZm8pLCBrZXkpCiAgICAgICAgd2FsbGV0X2ZpbGUud3JpdGUoZW5jcnlwdGVkX2RhdGEpCgpkZWYgZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpOgogICAgaWYgY3J5cHRvX3R5cGUgPT0gImV0aGVyZXVtIjoKICAgICAgICBhY2NvdW50ID0gQWNjb3VudC5jcmVhdGUoKQogICAgICAgIHJldHVybiBhY2NvdW50LmFkZHJlc3MsIGFjY291bnQua2V5LmhleCgpCiAgICBlbHNlOgogICAgICAgIHdhbGxldCA9IFdhbGxldC5jcmVhdGUoZidVU0JXYWxsZXRfe2NyeXB0b190eXBlfScpCiAgICAgICAga2V5ID0gd2FsbGV0Lm5ld19rZXkoKQogICAgICAgIHJldHVybiBrZXkuYWRkcmVzcywga2V5LnByaXZhdGVfaGV4CgpkZWYgb25fcGluX2VudHJ5KGV2ZW50PU5vbmUpOgogICAgc3RvcmVkX3BpbiA9IGdldF9waW4oa2V5KQogICAgZW50ZXJlZF9waW4gPSBndWkucGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc3VjY2Vzc2Z1bCB2ZXJpZmljYXRpb24KICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBndWkucGluX2NvbmZpcm1fZW50cnkuZ2V0KCkKICAgICAgICBpZiBlbnRlcmVkX3BpbiA9PSBjb25maXJtX3BpbjoKICAgICAgICAgICAgc2V0X3BpbihlbnRlcmVkX3Bpbiwga2V5KQogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgIk5ldyBQSU4gc2V0IHN1Y2Nlc3NmdWxseS4iKQogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc2V0dGluZyB0aGUgbmV3IFBJTgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgdmlld19rZXlzKGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBpZiBjcnlwdG9fdHlwZSBpbiB3YWxsZXRfaW5mbzoKICAgICAgICBwdWJfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXQogICAgICAgIHByaXZfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdCiAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbyhmIntjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9IEtleXMiLCBmIlB1YmxpYyBLZXk6IHtwdWJfa2V5fVxuUHJpdmF0ZSBLZXk6IHtwcml2X2tleX0iKQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCBmIk5vIGtleXMgZm91bmQgZm9yIHtjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9LiIpCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcywgcHJpdmF0ZV9rZXkgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdID0gcHJpdmF0ZV9rZXkKICAgIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSkKCiAgICAjIFJlZnJlc2ggd2FsbGV0IHdpbmRvdwogICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyh3YWxsZXRfaW5mbywga2V5KQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGtleSA9IGxvYWRfa2V5KCkKICAgIHBpbiA9IGdldF9waW4oa2V5KQogICAgCiAgICBndWkgPSBXYWxsZXRHVUkob25fZ2VuZXJhdGVfYWRkcmVzcywgdmlld19rZXlzLCBXYWxsZXRHVUkuY29weV90b19jbGlwYm9hcmQpCiAgICBndWkuc2hvd19waW5fd2luZG93KG9uX3Bpbl9lbnRyeSwgcGluKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAK0QAAAAAAAAAAAAAAAA8L8"
				],
				[
					473,
					1,
					"paste",
					null,
					"AgAAAGgOAAAAAAAArhAAAAAAAAAAAAAArhAAAAAAAACuEAAAAAAAAOEAAABkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcywgcHJpdmF0ZV9rZXkgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgd2FsbGV0X2luZm8",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABoDgAAAAAAAEkPAAAAAAAAAAAAAAAA8L8"
				],
				[
					480,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAArRAAAAAAAAAAAAAArRAAAAAAAACtEAAAAAAAAK4QAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKZnJvbSBldGhfYWNjb3VudCBpbXBvcnQgQWNjb3VudApmcm9tIGJpdGNvaW5saWIud2FsbGV0cyBpbXBvcnQgV2FsbGV0CmZyb20gZ3VpIGltcG9ydCBXYWxsZXRHVUkKCldBTExFVF9GSUxFID0gIndhbGxldF9pbmZvLmVuYyIKUElOX0ZJTEUgPSAicGluLmVuYyIKCmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgpkZWYgc2V0X3BpbihuZXdfcGluLCBrZXkpOgogICAgZW5jcnlwdGVkX3BpbiA9IGVuY3J5cHQobmV3X3Bpbiwga2V5KQogICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAid2IiKSBhcyBwaW5fZmlsZToKICAgICAgICBwaW5fZmlsZS53cml0ZShlbmNyeXB0ZWRfcGluKQoKZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlKToKICAgICAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSB3YWxsZXRfZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0KGVuY3J5cHRlZF9kYXRhLCBrZXkpKQogICAgZWxzZToKICAgICAgICB3YWxsZXRfaW5mbyA9IHsKICAgICAgICAgICAgImJpdGNvaW4iOiB7IndhbGxldCI6ICJiaXRjb2luX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImJpdGNvaW5fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJldGhlcmV1bSI6IHsid2FsbGV0IjogImV0aGVyZXVtX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogImV0aGVyZXVtX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAieHJwIjogeyJ3YWxsZXQiOiAieHJwX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInhycF9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInNoaWJhX2ludSI6IHsid2FsbGV0IjogInNoaWJhX3dhbGxldF9hZGRyZXNzIiwgInByaXZhdGVfa2V5IjogInNoaWJhX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB3YWxsZXRfaW5mbwoKZGVmIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSk6CiAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJ3YiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgIGVuY3J5cHRlZF9kYXRhID0gZW5jcnlwdChqc29uLmR1bXBzKHdhbGxldF9pbmZvKSwga2V5KQogICAgICAgIHdhbGxldF9maWxlLndyaXRlKGVuY3J5cHRlZF9kYXRhKQoKZGVmIGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKToKICAgIGlmIGNyeXB0b190eXBlID09ICJldGhlcmV1bSI6CiAgICAgICAgYWNjb3VudCA9IEFjY291bnQuY3JlYXRlKCkKICAgICAgICByZXR1cm4gYWNjb3VudC5hZGRyZXNzLCBhY2NvdW50LmtleS5oZXgoKQogICAgZWxzZToKICAgICAgICB3YWxsZXQgPSBXYWxsZXQuY3JlYXRlKGYnVVNCV2FsbGV0X3tjcnlwdG9fdHlwZX0nKQogICAgICAgIGtleSA9IHdhbGxldC5uZXdfa2V5KCkKICAgICAgICByZXR1cm4ga2V5LmFkZHJlc3MsIGtleS5wcml2YXRlX2hleAoKZGVmIG9uX3Bpbl9lbnRyeShldmVudD1Ob25lKToKICAgIHN0b3JlZF9waW4gPSBnZXRfcGluKGtleSkKICAgIGVudGVyZWRfcGluID0gZ3VpLnBpbl9lbnRyeS5nZXQoKQogICAgaWYgc3RvcmVkX3BpbjoKICAgICAgICBpZiB2ZXJpZnlfcGluKHN0b3JlZF9waW4sIGVudGVyZWRfcGluKToKICAgICAgICAgICAgZ3VpLnBpbl93aW5kb3cuZGVzdHJveSgpICAjIENsb3NlIHRoZSBQSU4gd2luZG93IGFmdGVyIHN1Y2Nlc3NmdWwgdmVyaWZpY2F0aW9uCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICBlbHNlOgogICAgICAgIGNvbmZpcm1fcGluID0gZ3VpLnBpbl9jb25maXJtX2VudHJ5LmdldCgpCiAgICAgICAgaWYgZW50ZXJlZF9waW4gPT0gY29uZmlybV9waW46CiAgICAgICAgICAgIHNldF9waW4oZW50ZXJlZF9waW4sIGtleSkKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygiU3VjY2VzcyIsICJOZXcgUElOIHNldCBzdWNjZXNzZnVsbHkuIikKICAgICAgICAgICAgZ3VpLnBpbl93aW5kb3cuZGVzdHJveSgpICAjIENsb3NlIHRoZSBQSU4gd2luZG93IGFmdGVyIHNldHRpbmcgdGhlIG5ldyBQSU4KICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiUElOcyBkbyBub3QgbWF0Y2guIFRyeSBhZ2Fpbi4iKQoKZGVmIHZpZXdfa2V5cyhjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgaWYgY3J5cHRvX3R5cGUgaW4gd2FsbGV0X2luZm86CiAgICAgICAgcHViX2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0KICAgICAgICBwcml2X2tleSA9IHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oZiJ7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfSBLZXlzIiwgZiJQdWJsaWMgS2V5OiB7cHViX2tleX1cblByaXZhdGUgS2V5OiB7cHJpdl9rZXl9IikKICAgIGVsc2U6CiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgZiJObyBrZXlzIGZvdW5kIGZvciB7Y3J5cHRvX3R5cGUuY2FwaXRhbGl6ZSgpfS4iKQoKZGVmIG9uX2dlbmVyYXRlX2FkZHJlc3Mod2FsbGV0X2ZyYW1lLCBjcnlwdG9fdHlwZSk6CiAgICB3YWxsZXRfaW5mbyA9IGxvYWRfd2FsbGV0X2luZm8oa2V5KQogICAgbmV3X2FkZHJlc3MsIHByaXZhdGVfa2V5ID0gZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdID0gbmV3X2FkZHJlc3MKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsicHJpdmF0ZV9rZXkiXSA9IHByaXZhdGVfa2V5CiAgICBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpCgogICAgIyBSZWZyZXNoIHdhbGxldCB3aW5kb3cKICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cod2FsbGV0X2luZm8sIGtleSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBrZXkgPSBsb2FkX2tleSgpCiAgICBwaW4gPSBnZXRfcGluKGtleSkKICAgIAogICAgZ3VpID0gV2FsbGV0R1VJKG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikK",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAK4QAAAAAAAAAAAAAAAA8L8"
				],
				[
					487,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAArRAAAAAAAAAAAAAArRAAAAAAAACtEAAAAAAAAK0QAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKZnJvbSBldGhfYWNjb3VudCBpbXBvcnQgQWNjb3VudApmcm9tIGJpdGNvaW5saWIud2FsbGV0cyBpbXBvcnQgV2FsbGV0CmZyb20gZ3VpIGltcG9ydCBXYWxsZXRHVUkKCldBTExFVF9GSUxFID0gIndhbGxldF9pbmZvLmVuYyIKUElOX0ZJTEUgPSAicGluLmVuYyIKCmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgpkZWYgc2V0X3BpbihuZXdfcGluLCBrZXkpOgogICAgZW5jcnlwdGVkX3BpbiA9IGVuY3J5cHQobmV3X3Bpbiwga2V5KQogICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAid2IiKSBhcyBwaW5fZmlsZToKICAgICAgICBwaW5fZmlsZS53cml0ZShlbmNyeXB0ZWRfcGluKQoKZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IHdhbGxldF9maWxlLnJlYWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGRlY3J5cHQoZW5jcnlwdGVkX2RhdGEsIGtleSkpCiAgICBlbHNlOgogICAgICAgIHdhbGxldF9pbmZvID0gewogICAgICAgICAgICAiYml0Y29pbiI6IHsid2FsbGV0IjogImJpdGNvaW5fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiYml0Y29pbl9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgImV0aGVyZXVtIjogeyJ3YWxsZXQiOiAiZXRoZXJldW1fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiZXRoZXJldW1fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJ4cnAiOiB7IndhbGxldCI6ICJ4cnBfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAieHJwX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAic2hpYmFfaW51IjogeyJ3YWxsZXQiOiAic2hpYmFfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAic2hpYmFfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdhbGxldF9pbmZvCgpkZWYgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KToKICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgIndiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSBlbmNyeXB0KGpzb24uZHVtcHMod2FsbGV0X2luZm8pLCBrZXkpCiAgICAgICAgd2FsbGV0X2ZpbGUud3JpdGUoZW5jcnlwdGVkX2RhdGEpCgpkZWYgZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpOgogICAgaWYgY3J5cHRvX3R5cGUgPT0gImV0aGVyZXVtIjoKICAgICAgICBhY2NvdW50ID0gQWNjb3VudC5jcmVhdGUoKQogICAgICAgIHJldHVybiBhY2NvdW50LmFkZHJlc3MsIGFjY291bnQua2V5LmhleCgpCiAgICBlbHNlOgogICAgICAgIHdhbGxldCA9IFdhbGxldC5jcmVhdGUoZidVU0JXYWxsZXRfe2NyeXB0b190eXBlfScpCiAgICAgICAga2V5ID0gd2FsbGV0Lm5ld19rZXkoKQogICAgICAgIHJldHVybiBrZXkuYWRkcmVzcywga2V5LnByaXZhdGVfaGV4CgpkZWYgb25fcGluX2VudHJ5KGV2ZW50PU5vbmUpOgogICAgc3RvcmVkX3BpbiA9IGdldF9waW4oa2V5KQogICAgZW50ZXJlZF9waW4gPSBndWkucGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc3VjY2Vzc2Z1bCB2ZXJpZmljYXRpb24KICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBndWkucGluX2NvbmZpcm1fZW50cnkuZ2V0KCkKICAgICAgICBpZiBlbnRlcmVkX3BpbiA9PSBjb25maXJtX3BpbjoKICAgICAgICAgICAgc2V0X3BpbihlbnRlcmVkX3Bpbiwga2V5KQogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgIk5ldyBQSU4gc2V0IHN1Y2Nlc3NmdWxseS4iKQogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc2V0dGluZyB0aGUgbmV3IFBJTgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgdmlld19rZXlzKGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBpZiBjcnlwdG9fdHlwZSBpbiB3YWxsZXRfaW5mbzoKICAgICAgICBwdWJfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXQogICAgICAgIHByaXZfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdCiAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbyhmIntjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9IEtleXMiLCBmIlB1YmxpYyBLZXk6IHtwdWJfa2V5fVxuUHJpdmF0ZSBLZXk6IHtwcml2X2tleX0iKQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCBmIk5vIGtleXMgZm91bmQgZm9yIHtjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9LiIpCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcywgcHJpdmF0ZV9rZXkgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdID0gcHJpdmF0ZV9rZXkKICAgIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSkKCiAgICAjIFJlZnJlc2ggd2FsbGV0IHdpbmRvdwogICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyh3YWxsZXRfaW5mbywga2V5KQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGtleSA9IGxvYWRfa2V5KCkKICAgIHBpbiA9IGdldF9waW4oa2V5KQogICAgCiAgICBndWkgPSBXYWxsZXRHVUkob25fZ2VuZXJhdGVfYWRkcmVzcywgdmlld19rZXlzLCBXYWxsZXRHVUkuY29weV90b19jbGlwYm9hcmQpCiAgICBndWkuc2hvd19waW5fd2luZG93KG9uX3Bpbl9lbnRyeSwgcGluKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAK0QAAAAAAAAAAAAAAAA8L8"
				],
				[
					502,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAbxEAAAAAAAAAAAAAbxEAAAAAAABvEQAAAAAAAK0QAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKZnJvbSBldGhfYWNjb3VudCBpbXBvcnQgQWNjb3VudApmcm9tIGJpdGNvaW5saWIud2FsbGV0cyBpbXBvcnQgV2FsbGV0CmZyb20gZ3VpIGltcG9ydCBXYWxsZXRHVUkKCldBTExFVF9GSUxFID0gIndhbGxldF9pbmZvLmVuYyIKUElOX0ZJTEUgPSAicGluLmVuYyIKCmRlZiBsb2FkX2tleSgpOgogICAgaWYgb3MucGF0aC5leGlzdHMoInNlY3JldC5rZXkiKToKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAicmIiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAgcmV0dXJuIGtleV9maWxlLnJlYWQoKQogICAgZWxzZToKICAgICAgICBrZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKICAgICAgICB3aXRoIG9wZW4oInNlY3JldC5rZXkiLCAid2IiKSBhcyBrZXlfZmlsZToKICAgICAgICAgICAga2V5X2ZpbGUud3JpdGUoa2V5KQogICAgICAgIHJldHVybiBrZXkKCmRlZiBlbmNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmVuY3J5cHQoZGF0YS5lbmNvZGUoKSkKCmRlZiBkZWNyeXB0KGRhdGEsIGtleSk6CiAgICBmID0gRmVybmV0KGtleSkKICAgIHJldHVybiBmLmRlY3J5cHQoZGF0YSkuZGVjb2RlKCkKCmRlZiBnZXRfcGluKGtleSk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cyhQSU5fRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAicmIiKSBhcyBwaW5fZmlsZToKICAgICAgICAgICAgZW5jcnlwdGVkX3BpbiA9IHBpbl9maWxlLnJlYWQoKQogICAgICAgIHBpbiA9IGRlY3J5cHQoZW5jcnlwdGVkX3Bpbiwga2V5KQogICAgZWxzZToKICAgICAgICBwaW4gPSBOb25lCiAgICByZXR1cm4gcGluCgpkZWYgc2V0X3BpbihuZXdfcGluLCBrZXkpOgogICAgZW5jcnlwdGVkX3BpbiA9IGVuY3J5cHQobmV3X3Bpbiwga2V5KQogICAgd2l0aCBvcGVuKFBJTl9GSUxFLCAid2IiKSBhcyBwaW5fZmlsZToKICAgICAgICBwaW5fZmlsZS53cml0ZShlbmNyeXB0ZWRfcGluKQoKZGVmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgaWYgZW50ZXJlZF9waW4gPT0gc3RvcmVkX3BpbjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCAiSW5jb3JyZWN0IFBJTi4iKQogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGxvYWRfd2FsbGV0X2luZm8oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFdBTExFVF9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oV0FMTEVUX0ZJTEUsICJyYiIpIGFzIHdhbGxldF9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IHdhbGxldF9maWxlLnJlYWQoKQogICAgICAgIHJldHVybiBqc29uLmxvYWRzKGRlY3J5cHQoZW5jcnlwdGVkX2RhdGEsIGtleSkpCiAgICBlbHNlOgogICAgICAgIHdhbGxldF9pbmZvID0gewogICAgICAgICAgICAiYml0Y29pbiI6IHsid2FsbGV0IjogImJpdGNvaW5fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiYml0Y29pbl9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgImV0aGVyZXVtIjogeyJ3YWxsZXQiOiAiZXRoZXJldW1fd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAiZXRoZXJldW1fcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJ4cnAiOiB7IndhbGxldCI6ICJ4cnBfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAieHJwX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAic2hpYmFfaW51IjogeyJ3YWxsZXQiOiAic2hpYmFfd2FsbGV0X2FkZHJlc3MiLCAicHJpdmF0ZV9rZXkiOiAic2hpYmFfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdhbGxldF9pbmZvCgpkZWYgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KToKICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgIndiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgZW5jcnlwdGVkX2RhdGEgPSBlbmNyeXB0KGpzb24uZHVtcHMod2FsbGV0X2luZm8pLCBrZXkpCiAgICAgICAgd2FsbGV0X2ZpbGUud3JpdGUoZW5jcnlwdGVkX2RhdGEpCgpkZWYgZ2VuZXJhdGVfbmV3X2FkZHJlc3MoY3J5cHRvX3R5cGUpOgogICAgaWYgY3J5cHRvX3R5cGUgPT0gImV0aGVyZXVtIjoKICAgICAgICBhY2NvdW50ID0gQWNjb3VudC5jcmVhdGUoKQogICAgICAgIHJldHVybiBhY2NvdW50LmFkZHJlc3MsIGFjY291bnQua2V5LmhleCgpCiAgICBlbHNlOgogICAgICAgIHdhbGxldCA9IFdhbGxldC5jcmVhdGUoZidVU0JXYWxsZXRfe2NyeXB0b190eXBlfScpCiAgICAgICAga2V5ID0gd2FsbGV0Lm5ld19rZXkoKQogICAgICAgIHJldHVybiBrZXkuYWRkcmVzcywga2V5LnByaXZhdGVfaGV4CgpkZWYgb25fcGluX2VudHJ5KGV2ZW50PU5vbmUpOgogICAgc3RvcmVkX3BpbiA9IGdldF9waW4oa2V5KQogICAgZW50ZXJlZF9waW4gPSBndWkucGluX2VudHJ5LmdldCgpCiAgICBpZiBzdG9yZWRfcGluOgogICAgICAgIGlmIHZlcmlmeV9waW4oc3RvcmVkX3BpbiwgZW50ZXJlZF9waW4pOgogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc3VjY2Vzc2Z1bCB2ZXJpZmljYXRpb24KICAgICAgICAgICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyhsb2FkX3dhbGxldF9pbmZvKGtleSksIGtleSkKICAgIGVsc2U6CiAgICAgICAgY29uZmlybV9waW4gPSBndWkucGluX2NvbmZpcm1fZW50cnkuZ2V0KCkKICAgICAgICBpZiBlbnRlcmVkX3BpbiA9PSBjb25maXJtX3BpbjoKICAgICAgICAgICAgc2V0X3BpbihlbnRlcmVkX3Bpbiwga2V5KQogICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCJTdWNjZXNzIiwgIk5ldyBQSU4gc2V0IHN1Y2Nlc3NmdWxseS4iKQogICAgICAgICAgICBndWkucGluX3dpbmRvdy5kZXN0cm95KCkgICMgQ2xvc2UgdGhlIFBJTiB3aW5kb3cgYWZ0ZXIgc2V0dGluZyB0aGUgbmV3IFBJTgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5zIGRvIG5vdCBtYXRjaC4gVHJ5IGFnYWluLiIpCgpkZWYgdmlld19rZXlzKGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBpZiBjcnlwdG9fdHlwZSBpbiB3YWxsZXRfaW5mbzoKICAgICAgICBwdWJfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXQogICAgICAgIHByaXZfa2V5ID0gd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdCiAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbyhmIntjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9IEtleXMiLCBmIlB1YmxpYyBLZXk6IHtwdWJfa2V5fVxuUHJpdmF0ZSBLZXk6IHtwcml2X2tleX0iKQogICAgZWxzZToKICAgICAgICBtZXNzYWdlYm94LnNob3dlcnJvcigiRXJyb3IiLCBmIk5vIGtleXMgZm91bmQgZm9yIHtjcnlwdG9fdHlwZS5jYXBpdGFsaXplKCl9LiIpCgpkZWYgb25fZ2VuZXJhdGVfYWRkcmVzcyh3YWxsZXRfZnJhbWUsIGNyeXB0b190eXBlKToKICAgIHdhbGxldF9pbmZvID0gbG9hZF93YWxsZXRfaW5mbyhrZXkpCiAgICBuZXdfYWRkcmVzcywgcHJpdmF0ZV9rZXkgPSBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSkKICAgIHdhbGxldF9pbmZvW2NyeXB0b190eXBlXVsid2FsbGV0Il0gPSBuZXdfYWRkcmVzcwogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJwcml2YXRlX2tleSJdID0gcHJpdmF0ZV9rZXkKICAgIHNhdmVfd2FsbGV0X2luZm8od2FsbGV0X2luZm8sIGtleSkKCiAgICAjIFJlZnJlc2ggd2FsbGV0IHdpbmRvdwogICAgZ3VpLm9wZW5fd2FsbGV0X3dpbmRvdyh3YWxsZXRfaW5mbywga2V5KQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGtleSA9IGxvYWRfa2V5KCkKICAgIHBpbiA9IGdldF9waW4oa2V5KQogICAgCiAgICBndWkgPSBXYWxsZXRHVUkob25fZ2VuZXJhdGVfYWRkcmVzcywgdmlld19rZXlzLCBXYWxsZXRHVUkuY29weV90b19jbGlwYm9hcmQpCiAgICBndWkuc2hvd19waW5fd2luZG93KG9uX3Bpbl9lbnRyeSwgcGluKQo",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAK0QAAAAAAAAAAAAAAAA8L8"
				],
				[
					518,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAAygwAAAAAAAAAAAAAygwAAAAAAADKDAAAAAAAAG8RAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSB0a2ludGVyIGltcG9ydCBUaywgbWVzc2FnZWJveApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGV0aF9hY2NvdW50IGltcG9ydCBBY2NvdW50CmZyb20gYml0Y29pbmxpYi53YWxsZXRzIGltcG9ydCBXYWxsZXQKZnJvbSBndWkgaW1wb3J0IFdhbGxldEdVSQoKV0FMTEVUX0ZJTEUgPSAid2FsbGV0X2luZm8uZW5jIgpQSU5fRklMRSA9ICJwaW4uZW5jIgoKZGVmIGxvYWRfa2V5KCk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cygic2VjcmV0LmtleSIpOgogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJyYiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICByZXR1cm4ga2V5X2ZpbGUucmVhZCgpCiAgICBlbHNlOgogICAgICAgIGtleSA9IEZlcm5ldC5nZW5lcmF0ZV9rZXkoKQogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJ3YiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICBrZXlfZmlsZS53cml0ZShrZXkpCiAgICAgICAgcmV0dXJuIGtleQoKZGVmIGVuY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZW5jcnlwdChkYXRhLmVuY29kZSgpKQoKZGVmIGRlY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZGVjcnlwdChkYXRhKS5kZWNvZGUoKQoKZGVmIGdldF9waW4oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFBJTl9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJyYiIpIGFzIHBpbl9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfcGluID0gcGluX2ZpbGUucmVhZCgpCiAgICAgICAgcGluID0gZGVjcnlwdChlbmNyeXB0ZWRfcGluLCBrZXkpCiAgICBlbHNlOgogICAgICAgIHBpbiA9IE5vbmUKICAgIHJldHVybiBwaW4KCmRlZiBzZXRfcGluKG5ld19waW4sIGtleSk6CiAgICBlbmNyeXB0ZWRfcGluID0gZW5jcnlwdChuZXdfcGluLCBrZXkpCiAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJ3YiIpIGFzIHBpbl9maWxlOgogICAgICAgIHBpbl9maWxlLndyaXRlKGVuY3J5cHRlZF9waW4pCgpkZWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICBpZiBlbnRlcmVkX3BpbiA9PSBzdG9yZWRfcGluOgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJJbmNvcnJlY3QgUElOLiIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgbG9hZF93YWxsZXRfaW5mbyhrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoV0FMTEVUX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgInJiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gd2FsbGV0X2ZpbGUucmVhZCgpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSwga2V5KSkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJiaXRjb2luX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJldGhlcmV1bV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJ4cnBfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJzaGliYV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCmRlZiBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpOgogICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAid2IiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IGVuY3J5cHQoanNvbi5kdW1wcyh3YWxsZXRfaW5mbyksIGtleSkKICAgICAgICB3YWxsZXRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKCmRlZiBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSk6CiAgICBpZiBjcnlwdG9fdHlwZSA9PSAiZXRoZXJldW0iOgogICAgICAgIGFjY291bnQgPSBBY2NvdW50LmNyZWF0ZSgpCiAgICAgICAgcmV0dXJuIGFjY291bnQuYWRkcmVzcywgYWNjb3VudC5rZXkuaGV4KCkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0ID0gV2FsbGV0LmNyZWF0ZShmJ1VTQldhbGxldF97Y3J5cHRvX3R5cGV9JykKICAgICAgICBrZXkgPSB3YWxsZXQubmV3X2tleSgpCiAgICAgICAgcmV0dXJuIGtleS5hZGRyZXNzLCBrZXkucHJpdmF0ZV9oZXgKCmRlZiBvbl9waW5fZW50cnkoZXZlbnQ9Tm9uZSk6CiAgICBzdG9yZWRfcGluID0gZ2V0X3BpbihrZXkpCiAgICBlbnRlcmVkX3BpbiA9IGd1aS5waW5fZW50cnkuZ2V0KCkKICAgIGlmIHN0b3JlZF9waW46CiAgICAgICAgaWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzdWNjZXNzZnVsIHZlcmlmaWNhdGlvbgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzZXR0aW5nIHRoZSBuZXcgUElOCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiB2aWV3X2tleXMoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIGlmIGNyeXB0b190eXBlIGluIHdhbGxldF9pbmZvOgogICAgICAgIHB1Yl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdCiAgICAgICAgcHJpdl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0KICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKGYie2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gS2V5cyIsIGYiUHVibGljIEtleToge3B1Yl9rZXl9XG5Qcml2YXRlIEtleToge3ByaXZfa2V5fSIpCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiTm8ga2V5cyBmb3VuZCBmb3Ige2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0uIikKCmRlZiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIG5ld19hZGRyZXNzLCBwcml2YXRlX2tleSA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0gPSBwcml2YXRlX2tleQogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgUmVmcmVzaCB3YWxsZXQgd2luZG93CiAgICBndWkub3Blbl93YWxsZXRfd2luZG93KHdhbGxldF9pbmZvLCBrZXkpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCgogICAgcm9vdCA9IFRrKCkgICMgQ3JlYXRlIHRoZSBtYWluIFRraW50ZXIgcm9vdCB3aW5kb3cKICAgIHJvb3Qud2l0aGRyYXcoKSAgIyBIaWRlIHRoZSBtYWluIHdpbmRvdyBhcyB3ZSBkb24ndCB1c2UgaXQgZGlyZWN0bHkKICAgIAogICAgZ3VpID0gV2FsbGV0R1VJKG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikKCiAgICByb290Lm1haW5sb29wKCkgICMgU3RhcnQgdGhlIG1haW4gVGtpbnRlciBldmVudCBsb29wCg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAG8RAAAAAAAAAAAAAAAA8L8"
				],
				[
					523,
					1,
					"paste",
					null,
					"AgAAAMIMAAAAAAAAbxEAAAAAAAAAAAAAbxEAAAAAAABvEQAAAAAAAAgAAABkZWYgdmlldw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADCDAAAAAAAAMoMAAAAAAAAAAAAAAAA8L8"
				],
				[
					19,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAA7yIAAAAAAAAAAAAA7yIAAAAAAADvIgAAAAAAAG8RAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KZnJvbSB0a2ludGVyIGltcG9ydCBUaywgbWVzc2FnZWJveApmcm9tIGNyeXB0b2dyYXBoeS5mZXJuZXQgaW1wb3J0IEZlcm5ldApmcm9tIGV0aF9hY2NvdW50IGltcG9ydCBBY2NvdW50CmZyb20gYml0Y29pbmxpYi53YWxsZXRzIGltcG9ydCBXYWxsZXQKZnJvbSBndWkgaW1wb3J0IFdhbGxldEdVSQoKV0FMTEVUX0ZJTEUgPSAid2FsbGV0X2luZm8uZW5jIgpQSU5fRklMRSA9ICJwaW4uZW5jIgoKZGVmIGxvYWRfa2V5KCk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cygic2VjcmV0LmtleSIpOgogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJyYiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICByZXR1cm4ga2V5X2ZpbGUucmVhZCgpCiAgICBlbHNlOgogICAgICAgIGtleSA9IEZlcm5ldC5nZW5lcmF0ZV9rZXkoKQogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJ3YiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICBrZXlfZmlsZS53cml0ZShrZXkpCiAgICAgICAgcmV0dXJuIGtleQoKZGVmIGVuY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZW5jcnlwdChkYXRhLmVuY29kZSgpKQoKZGVmIGRlY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZGVjcnlwdChkYXRhKS5kZWNvZGUoKQoKZGVmIGdldF9waW4oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFBJTl9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJyYiIpIGFzIHBpbl9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfcGluID0gcGluX2ZpbGUucmVhZCgpCiAgICAgICAgcGluID0gZGVjcnlwdChlbmNyeXB0ZWRfcGluLCBrZXkpCiAgICBlbHNlOgogICAgICAgIHBpbiA9IE5vbmUKICAgIHJldHVybiBwaW4KCmRlZiBzZXRfcGluKG5ld19waW4sIGtleSk6CiAgICBlbmNyeXB0ZWRfcGluID0gZW5jcnlwdChuZXdfcGluLCBrZXkpCiAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJ3YiIpIGFzIHBpbl9maWxlOgogICAgICAgIHBpbl9maWxlLndyaXRlKGVuY3J5cHRlZF9waW4pCgpkZWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICBpZiBlbnRlcmVkX3BpbiA9PSBzdG9yZWRfcGluOgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJJbmNvcnJlY3QgUElOLiIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgbG9hZF93YWxsZXRfaW5mbyhrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoV0FMTEVUX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgInJiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gd2FsbGV0X2ZpbGUucmVhZCgpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSwga2V5KSkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJiaXRjb2luX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJldGhlcmV1bV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJ4cnBfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJzaGliYV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCmRlZiBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpOgogICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAid2IiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IGVuY3J5cHQoanNvbi5kdW1wcyh3YWxsZXRfaW5mbyksIGtleSkKICAgICAgICB3YWxsZXRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKCmRlZiBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSk6CiAgICBpZiBjcnlwdG9fdHlwZSA9PSAiZXRoZXJldW0iOgogICAgICAgIGFjY291bnQgPSBBY2NvdW50LmNyZWF0ZSgpCiAgICAgICAgcmV0dXJuIGFjY291bnQuYWRkcmVzcywgYWNjb3VudC5rZXkuaGV4KCkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0ID0gV2FsbGV0LmNyZWF0ZShmJ1VTQldhbGxldF97Y3J5cHRvX3R5cGV9JykKICAgICAgICBrZXkgPSB3YWxsZXQubmV3X2tleSgpCiAgICAgICAgcmV0dXJuIGtleS5hZGRyZXNzLCBrZXkucHJpdmF0ZV9oZXgKCmRlZiBvbl9waW5fZW50cnkoZXZlbnQ9Tm9uZSk6CiAgICBzdG9yZWRfcGluID0gZ2V0X3BpbihrZXkpCiAgICBlbnRlcmVkX3BpbiA9IGd1aS5waW5fZW50cnkuZ2V0KCkKICAgIGlmIHN0b3JlZF9waW46CiAgICAgICAgaWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzdWNjZXNzZnVsIHZlcmlmaWNhdGlvbgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzZXR0aW5nIHRoZSBuZXcgUElOCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiB2aWV3X2tleXMoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIGlmIGNyeXB0b190eXBlIGluIHdhbGxldF9pbmZvOgogICAgICAgIHB1Yl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdCiAgICAgICAgcHJpdl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0KICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKGYie2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gS2V5cyIsIGYiUHVibGljIEtleToge3B1Yl9rZXl9XG5Qcml2YXRlIEtleToge3ByaXZfa2V5fSIpCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiTm8ga2V5cyBmb3VuZCBmb3Ige2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0uIikKCmRlZiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIG5ld19hZGRyZXNzLCBwcml2YXRlX2tleSA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0gPSBwcml2YXRlX2tleQogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgUmVmcmVzaCB3YWxsZXQgd2luZG93CiAgICBndWkub3Blbl93YWxsZXRfd2luZG93KHdhbGxldF9pbmZvLCBrZXkpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCgogICAgcm9vdCA9IFRrKCkgICMgQ3JlYXRlIHRoZSBtYWluIFRraW50ZXIgcm9vdCB3aW5kb3cKICAgIHJvb3Qud2l0aGRyYXcoKSAgIyBIaWRlIHRoZSBtYWluIHdpbmRvdyBhcyB3ZSBkb24ndCB1c2UgaXQgZGlyZWN0bHkKICAgIAogICAgZ3VpID0gV2FsbGV0R1VJKG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikKCiAgICByb290Lm1haW5sb29wKCkgICMgU3RhcnQgdGhlIG1haW4gVGtpbnRlciBldmVudCBsb29wCg",
					"AQAAAAAAAAABAAAAAAAAAAAAAABvEQAAAAAAAAAAAAAAAPC/"
				],
				[
					24,
					1,
					"paste",
					null,
					"AgAAAMsiAAAAAAAA0icAAAAAAAAAAAAA0icAAAAAAADSJwAAAAAAACQAAAAgICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3g",
					"AQAAAAAAAAABAAAAyyIAAAAAAADvIgAAAAAAAAAAAAAAAPC/"
				],
				[
					32,
					1,
					"right_delete",
					null,
					"AQAAAMAbAAAAAAAAwBsAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAwBsAAAAAAADAGwAAAAAAAAAAAAAAAPC/"
				],
				[
					41,
					1,
					"paste",
					null,
					"AgAAAAAAAAAAAAAACSMAAAAAAAAAAAAACSMAAAAAAAAJIwAAAAAAANEnAABpbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRraW50ZXIgYXMgdGsKaW1wb3J0IHR0a2Jvb3RzdHJhcCBhcyB0dGsKZnJvbSB0a2ludGVyIGltcG9ydCBtZXNzYWdlYm94CmZyb20gY3J5cHRvZ3JhcGh5LmZlcm5ldCBpbXBvcnQgRmVybmV0CmZyb20gZXRoX2FjY291bnQgaW1wb3J0IEFjY291bnQKZnJvbSBiaXRjb2lubGliLndhbGxldHMgaW1wb3J0IFdhbGxldAoKV0FMTEVUX0ZJTEUgPSAid2FsbGV0X2luZm8uZW5jIgpQSU5fRklMRSA9ICJwaW4uZW5jIgoKY2xhc3MgV2FsbGV0R1VJOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgY29weV90b19jbGlwYm9hcmQpOgogICAgICAgIHNlbGYub25fZ2VuZXJhdGVfYWRkcmVzcyA9IG9uX2dlbmVyYXRlX2FkZHJlc3MKICAgICAgICBzZWxmLnZpZXdfa2V5cyA9IHZpZXdfa2V5cwogICAgICAgIHNlbGYuY29weV90b19jbGlwYm9hcmQgPSBjb3B5X3RvX2NsaXBib2FyZAogICAgICAgIHNlbGYucGluX3dpbmRvdyA9IE5vbmUKICAgICAgICBzZWxmLndhbGxldF93aW5kb3cgPSBOb25lCgogICAgZGVmIGFwcGx5X3RoZW1lKHNlbGYsIHdpbmRvdyk6CiAgICAgICAgIyBBcHBseSB0aGUgZGVzaXJlZCB0aGVtZSB0byB0aGUgd2luZG93CiAgICAgICAgc3R5bGUgPSB0dGsuU3R5bGUod2luZG93KQogICAgICAgIGF2YWlsYWJsZV90aGVtZXMgPSBzdHlsZS50aGVtZV9uYW1lcygpCiAgICAgICAgcHJpbnQoIkF2YWlsYWJsZSB0aGVtZXM6IiwgYXZhaWxhYmxlX3RoZW1lcykKICAgICAgICAKICAgICAgICAjIFVzZSBhIHZhbGlkIHRoZW1lIG5hbWUKICAgICAgICB0aGVtZV9uYW1lID0gInN1cGVyaGVybyIKICAgICAgICBpZiB0aGVtZV9uYW1lIGluIGF2YWlsYWJsZV90aGVtZXM6CiAgICAgICAgICAgIHN0eWxlLnRoZW1lX3VzZSh0aGVtZV9uYW1lKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiVGhlbWUgJ3t0aGVtZV9uYW1lfScgaXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIGNob29zZSBhIHZhbGlkIHRoZW1lIGZyb20gdGhlIGxpc3QgYWJvdmUuIikKICAgICAgICAKICAgICAgICAjIEN1c3RvbWl6ZSB0aGUgYnV0dG9uIGRlc2lnbgogICAgICAgIHN0eWxlLmNvbmZpZ3VyZSgnVEJ1dHRvbicsIGZvbnQ9KCdIZWx2ZXRpY2EnLCAxMiksIGJhY2tncm91bmQ9J2dyYXknLCBmb3JlZ3JvdW5kPSd3aGl0ZScpCiAgICAgICAgCiAgICAgICAgIyBDdXN0b21pemUgd2luZG93IGJhY2tncm91bmQgY29sb3IKICAgICAgICB3aW5kb3cuY29uZmlndXJlKGJnPSdibGFjaycpCgogICAgICAgICMgU2V0IHNjYWxpbmcKICAgICAgICB3aW5kb3cudGsuY2FsbCgndGsnLCAnc2NhbGluZycsIDEuMjUpCgogICAgZGVmIG9wZW5fd2FsbGV0X3dpbmRvdyhzZWxmLCB3YWxsZXRfaW5mbywga2V5KToKICAgICAgICAjIENsb3NlIGFueSBleGlzdGluZyB3YWxsZXQgd2luZG93IGZpcnN0CiAgICAgICAgaWYgc2VsZi53YWxsZXRfd2luZG93IGlzIG5vdCBOb25lIGFuZCBzZWxmLndhbGxldF93aW5kb3cud2luZm9fZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYud2FsbGV0X3dpbmRvdy5kZXN0cm95KCkKCiAgICAgICAgc2VsZi53YWxsZXRfd2luZG93ID0gdHRrLldpbmRvdygpCiAgICAgICAgc2VsZi5hcHBseV90aGVtZShzZWxmLndhbGxldF93aW5kb3cpCiAgICAgICAgc2VsZi53YWxsZXRfd2luZG93LnRpdGxlKCJVU0IgV2FsbGV0IEluZm9ybWF0aW9uIikKICAgICAgICBzZWxmLndhbGxldF93aW5kb3cuZ2VvbWV0cnkoIjYwMHg0MDAiKQoKICAgICAgICAjIE1ha2UgdGhlIHdpbmRvdyByZXNpemFibGUKICAgICAgICBzZWxmLndhbGxldF93aW5kb3cucmVzaXphYmxlKFRydWUsIFRydWUpCgogICAgICAgICMgV2FsbGV0IEluZm9ybWF0aW9uIEZyYW1lCiAgICAgICAgd2FsbGV0X2ZyYW1lID0gdHRrLkZyYW1lKHNlbGYud2FsbGV0X3dpbmRvdywgcGFkZGluZz0oMjAsIDEwKSkKICAgICAgICB3YWxsZXRfZnJhbWUucGFjayhmaWxsPSJib3RoIiwgZXhwYW5kPVRydWUpCgogICAgICAgIHdhbGxldF9sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9IldhbGxldCBJbmZvcm1hdGlvbiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxNiwgImJvbGQiKSwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgICAgICB3YWxsZXRfbGFiZWwuZ3JpZChyb3c9MCwgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0xMCkKCiAgICAgICAgIyBEaXNwbGF5aW5nIFdhbGxldCBJbmZvCiAgICAgICAgcm93ID0gMQogICAgICAgIGZvciBjcnlwdG8sIGluZm8gaW4gd2FsbGV0X2luZm8uaXRlbXMoKToKICAgICAgICAgICAgY3J5cHRvX2xhYmVsID0gdHRrLkxhYmVsKHdhbGxldF9mcmFtZSwgdGV4dD1mIntjcnlwdG8uY2FwaXRhbGl6ZSgpfSBBZGRyZXNzOiIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMiksIGJvb3RzdHlsZT0iaW5mbyIpCiAgICAgICAgICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUsIHBhZHg9MTApCgogICAgICAgICAgICBjcnlwdG9fdmFsdWUgPSB0dGsuTGFiZWwod2FsbGV0X2ZyYW1lLCB0ZXh0PWluZm9bIndhbGxldCJdLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImRlZmF1bHQiKQogICAgICAgICAgICBjcnlwdG9fdmFsdWUuZ3JpZChyb3c9cm93LCBjb2x1bW49MSwgc3RpY2t5PSJ3IiwgcGFkeT01KQoKICAgICAgICAgICAgY29weV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iQ29weSIsIGNvbW1hbmQ9bGFtYmRhIGFkZHJlc3M9aW5mb1sid2FsbGV0Il06IHNlbGYuY29weV90b19jbGlwYm9hcmQoYWRkcmVzcyksIGJvb3RzdHlsZT0iaW5mby1vdXRsaW5lIikKICAgICAgICAgICAgY29weV9idXR0b24uZ3JpZChyb3c9cm93LCBjb2x1bW49Miwgc3RpY2t5PSJ3IiwgcGFkeT01LCBwYWR4PTUpCgogICAgICAgICAgICByb3cgKz0gMQoKICAgICAgICAjIENyeXB0b2N1cnJlbmN5IHNlbGVjdGlvbgogICAgICAgIGNyeXB0b19sYWJlbCA9IHR0ay5MYWJlbCh3YWxsZXRfZnJhbWUsIHRleHQ9IlNlbGVjdCBDcnlwdG9jdXJyZW5jeToiLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpLCBib290c3R5bGU9ImluZm8iKQogICAgICAgIGNyeXB0b19sYWJlbC5ncmlkKHJvdz1yb3csIGNvbHVtbj0wLCBzdGlja3k9ImUiLCBwYWR5PTUsIHBhZHg9MTApCgogICAgICAgIHNlbGYuY3J5cHRvX29wdGlvbnMgPSBbImJpdGNvaW4iLCAiZXRoZXJldW0iLCAieHJwIiwgInNoaWJhX2ludSJdCiAgICAgICAgc2VsZi5zZWxlY3RlZF9jcnlwdG8gPSB0ay5TdHJpbmdWYXIoKQogICAgICAgIHNlbGYuc2VsZWN0ZWRfY3J5cHRvLnNldChzZWxmLmNyeXB0b19vcHRpb25zWzBdKSAgIyBEZWZhdWx0IHZhbHVlCgogICAgICAgIGNyeXB0b19kcm9wZG93biA9IHR0ay5Db21ib2JveCh3YWxsZXRfZnJhbWUsIHRleHR2YXJpYWJsZT1zZWxmLnNlbGVjdGVkX2NyeXB0bywgdmFsdWVzPXNlbGYuY3J5cHRvX29wdGlvbnMsIHN0YXRlPSJyZWFkb25seSIpCiAgICAgICAgY3J5cHRvX2Ryb3Bkb3duLmdyaWQocm93PXJvdywgY29sdW1uPTEsIHN0aWNreT0idyIsIHBhZHk9NSkKCiAgICAgICAgdmlld19idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iVmlldyBLZXlzIiwgY29tbWFuZD1sYW1iZGE6IHNlbGYudmlld19rZXlzKHNlbGYuc2VsZWN0ZWRfY3J5cHRvLmdldCgpKSwgYm9vdHN0eWxlPSJpbmZvLW91dGxpbmUiKQogICAgICAgIHZpZXdfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTIsIHN0aWNreT0idyIsIHBhZHk9NSwgcGFkeD01KQoKICAgICAgICByb3cgKz0gMQoKICAgICAgICBnZW5lcmF0ZV9idXR0b24gPSB0dGsuQnV0dG9uKHdhbGxldF9mcmFtZSwgdGV4dD0iR2VuZXJhdGUgTmV3IEFkZHJlc3MiLCBjb21tYW5kPWxhbWJkYTogc2VsZi5vbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgc2VsZi5zZWxlY3RlZF9jcnlwdG8uZ2V0KCkpLCBib290c3R5bGU9InN1Y2Nlc3Mtb3V0bGluZSIpCiAgICAgICAgZ2VuZXJhdGVfYnV0dG9uLmdyaWQocm93PXJvdywgY29sdW1uPTAsIGNvbHVtbnNwYW49MywgcGFkeT0yMCkKCiAgICAgICAgIyBDb25maWd1cmUgcm93IGFuZCBjb2x1bW4gd2VpZ2h0cwogICAgICAgIHdhbGxldF9mcmFtZS5ncmlkX3Jvd2NvbmZpZ3VyZShyb3csIHdlaWdodD0xKQogICAgICAgIHdhbGxldF9mcmFtZS5ncmlkX2NvbHVtbmNvbmZpZ3VyZSgwLCB3ZWlnaHQ9MSkKICAgICAgICB3YWxsZXRfZnJhbWUuZ3JpZF9jb2x1bW5jb25maWd1cmUoMSwgd2VpZ2h0PTIpCiAgICAgICAgd2FsbGV0X2ZyYW1lLmdyaWRfY29sdW1uY29uZmlndXJlKDIsIHdlaWdodD0xKQoKICAgIGRlZiBzaG93X3Bpbl93aW5kb3coc2VsZiwgb25fcGluX2VudHJ5LCBwaW49Tm9uZSk6CiAgICAgICAgIyBPbmx5IHNob3cgdGhlIHBpbiBlbnRyeSB3aW5kb3cgaWYgaXQncyBub3QgYWxyZWFkeSBvcGVuCiAgICAgICAgaWYgc2VsZi5waW5fd2luZG93IGlzIG5vdCBOb25lIGFuZCBzZWxmLnBpbl93aW5kb3cud2luZm9fZXhpc3RzKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZWxmLnBpbl93aW5kb3cgPSB0dGsuV2luZG93KCkKICAgICAgICBzZWxmLmFwcGx5X3RoZW1lKHNlbGYucGluX3dpbmRvdykKICAgICAgICBzZWxmLnBpbl93aW5kb3cudGl0bGUoIlVTQiBXYWxsZXQgLSBQSU4gRW50cnkiKQogICAgICAgIHNlbGYucGluX3dpbmRvdy5nZW9tZXRyeSgiNDAweDIwMCIpCiAgICAgICAgCiAgICAgICAgcGluX2xhYmVsID0gdHRrLkxhYmVsKHNlbGYucGluX3dpbmRvdywgdGV4dD0iRW50ZXIgeW91ciBQSU46IiwgYm9vdHN0eWxlPSJwcmltYXJ5IikKICAgICAgICBwaW5fbGFiZWwucGFjayhwYWR5PTEwKQoKICAgICAgICBzZWxmLnBpbl9lbnRyeSA9IHR0ay5FbnRyeShzZWxmLnBpbl93aW5kb3csIHNob3c9JyonLCBib290c3R5bGU9InByaW1hcnkiKQogICAgICAgIHNlbGYucGluX2VudHJ5LnBhY2socGFkeT0xMCkKCiAgICAgICAgaWYgcGluIGlzIE5vbmU6CiAgICAgICAgICAgIHBpbl9jb25maXJtX2xhYmVsID0gdHRrLkxhYmVsKHNlbGYucGluX3dpbmRvdywgdGV4dD0iQ29uZmlybSB5b3VyIFBJTjoiLCBib290c3R5bGU9InByaW1hcnkiKQogICAgICAgICAgICBwaW5fY29uZmlybV9sYWJlbC5wYWNrKHBhZHk9MTApCgogICAgICAgICAgICBzZWxmLnBpbl9jb25maXJtX2VudHJ5ID0gdHRrLkVudHJ5KHNlbGYucGluX3dpbmRvdywgc2hvdz0nKicsIGJvb3RzdHlsZT0icHJpbWFyeSIpCiAgICAgICAgICAgIHNlbGYucGluX2NvbmZpcm1fZW50cnkucGFjayhwYWR5PTEwKQoKICAgICAgICBzZWxmLnBpbl9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKICAgICAgICBpZiBwaW4gaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5waW5fY29uZmlybV9lbnRyeS5iaW5kKCI8UmV0dXJuPiIsIG9uX3Bpbl9lbnRyeSkKCiAgICAgICAgc3VibWl0X2J1dHRvbiA9IHR0ay5CdXR0b24oc2VsZi5waW5fd2luZG93LCB0ZXh0PSJTdWJtaXQgUElOIiwgY29tbWFuZD1vbl9waW5fZW50cnksIGJvb3RzdHlsZT0ic3VjY2Vzcy1vdXRsaW5lIikKICAgICAgICBzdWJtaXRfYnV0dG9uLnBhY2socGFkeT0xMCkKCiAgICAgICAgc2VsZi5waW5fd2luZG93Lm1haW5sb29wKCkKCiAgICBkZWYgY29weV90b19jbGlwYm9hcmQoc2VsZiwgYWRkcmVzcyk6CiAgICAgICAgc2VsZi53YWxsZXRfd2luZG93LmNsaXBib2FyZF9jbGVhcigpCiAgICAgICAgc2VsZi53YWxsZXRfd2luZG93LmNsaXBib2FyZF9hcHBlbmQoYWRkcmVzcykKICAgICAgICBzZWxmLndhbGxldF93aW5kb3cudXBkYXRlKCkgICMgS2VlcCB0aGUgY2xpcGJvYXJkIGRhdGEgYXZhaWxhYmxlCiAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygiQ29waWVkIiwgIkFkZHJlc3MgY29waWVkIHRvIGNsaXBib2FyZC4iKQoKZGVmIGxvYWRfa2V5KCk6CiAgICBpZiBvcy5wYXRoLmV4aXN0cygic2VjcmV0LmtleSIpOgogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJyYiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICByZXR1cm4ga2V5X2ZpbGUucmVhZCgpCiAgICBlbHNlOgogICAgICAgIGtleSA9IEZlcm5ldC5nZW5lcmF0ZV9rZXkoKQogICAgICAgIHdpdGggb3Blbigic2VjcmV0LmtleSIsICJ3YiIpIGFzIGtleV9maWxlOgogICAgICAgICAgICBrZXlfZmlsZS53cml0ZShrZXkpCiAgICAgICAgcmV0dXJuIGtleQoKZGVmIGVuY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZW5jcnlwdChkYXRhLmVuY29kZSgpKQoKZGVmIGRlY3J5cHQoZGF0YSwga2V5KToKICAgIGYgPSBGZXJuZXQoa2V5KQogICAgcmV0dXJuIGYuZGVjcnlwdChkYXRhKS5kZWNvZGUoKQoKZGVmIGdldF9waW4oa2V5KToKICAgIGlmIG9zLnBhdGguZXhpc3RzKFBJTl9GSUxFKToKICAgICAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJyYiIpIGFzIHBpbl9maWxlOgogICAgICAgICAgICBlbmNyeXB0ZWRfcGluID0gcGluX2ZpbGUucmVhZCgpCiAgICAgICAgcGluID0gZGVjcnlwdChlbmNyeXB0ZWRfcGluLCBrZXkpCiAgICBlbHNlOgogICAgICAgIHBpbiA9IE5vbmUKICAgIHJldHVybiBwaW4KCmRlZiBzZXRfcGluKG5ld19waW4sIGtleSk6CiAgICBlbmNyeXB0ZWRfcGluID0gZW5jcnlwdChuZXdfcGluLCBrZXkpCiAgICB3aXRoIG9wZW4oUElOX0ZJTEUsICJ3YiIpIGFzIHBpbl9maWxlOgogICAgICAgIHBpbl9maWxlLndyaXRlKGVuY3J5cHRlZF9waW4pCgpkZWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICBpZiBlbnRlcmVkX3BpbiA9PSBzdG9yZWRfcGluOgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJJbmNvcnJlY3QgUElOLiIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgbG9hZF93YWxsZXRfaW5mbyhrZXkpOgogICAgaWYgb3MucGF0aC5leGlzdHMoV0FMTEVUX0ZJTEUpOgogICAgICAgIHdpdGggb3BlbihXQUxMRVRfRklMRSwgInJiIikgYXMgd2FsbGV0X2ZpbGU6CiAgICAgICAgICAgIGVuY3J5cHRlZF9kYXRhID0gd2FsbGV0X2ZpbGUucmVhZCgpCiAgICAgICAgcmV0dXJuIGpzb24ubG9hZHMoZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSwga2V5KSkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0X2luZm8gPSB7CiAgICAgICAgICAgICJiaXRjb2luIjogeyJ3YWxsZXQiOiAiYml0Y29pbl93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJiaXRjb2luX3ByaXZhdGVfa2V5IiwgImJhbGFuY2UiOiAwLjB9LAogICAgICAgICAgICAiZXRoZXJldW0iOiB7IndhbGxldCI6ICJldGhlcmV1bV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJldGhlcmV1bV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfSwKICAgICAgICAgICAgInhycCI6IHsid2FsbGV0IjogInhycF93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJ4cnBfcHJpdmF0ZV9rZXkiLCAiYmFsYW5jZSI6IDAuMH0sCiAgICAgICAgICAgICJzaGliYV9pbnUiOiB7IndhbGxldCI6ICJzaGliYV93YWxsZXRfYWRkcmVzcyIsICJwcml2YXRlX2tleSI6ICJzaGliYV9wcml2YXRlX2tleSIsICJiYWxhbmNlIjogMC4wfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2FsbGV0X2luZm8KCmRlZiBzYXZlX3dhbGxldF9pbmZvKHdhbGxldF9pbmZvLCBrZXkpOgogICAgd2l0aCBvcGVuKFdBTExFVF9GSUxFLCAid2IiKSBhcyB3YWxsZXRfZmlsZToKICAgICAgICBlbmNyeXB0ZWRfZGF0YSA9IGVuY3J5cHQoanNvbi5kdW1wcyh3YWxsZXRfaW5mbyksIGtleSkKICAgICAgICB3YWxsZXRfZmlsZS53cml0ZShlbmNyeXB0ZWRfZGF0YSkKCmRlZiBnZW5lcmF0ZV9uZXdfYWRkcmVzcyhjcnlwdG9fdHlwZSk6CiAgICBpZiBjcnlwdG9fdHlwZSA9PSAiZXRoZXJldW0iOgogICAgICAgIGFjY291bnQgPSBBY2NvdW50LmNyZWF0ZSgpCiAgICAgICAgcmV0dXJuIGFjY291bnQuYWRkcmVzcywgYWNjb3VudC5rZXkuaGV4KCkKICAgIGVsc2U6CiAgICAgICAgd2FsbGV0ID0gV2FsbGV0LmNyZWF0ZShmJ1VTQldhbGxldF97Y3J5cHRvX3R5cGV9JykKICAgICAgICBrZXkgPSB3YWxsZXQubmV3X2tleSgpCiAgICAgICAgcmV0dXJuIGtleS5hZGRyZXNzLCBrZXkucHJpdmF0ZV9oZXgKCmRlZiBvbl9waW5fZW50cnkoZXZlbnQ9Tm9uZSk6CiAgICBzdG9yZWRfcGluID0gZ2V0X3BpbihrZXkpCiAgICBlbnRlcmVkX3BpbiA9IGd1aS5waW5fZW50cnkuZ2V0KCkKICAgIGlmIHN0b3JlZF9waW46CiAgICAgICAgaWYgdmVyaWZ5X3BpbihzdG9yZWRfcGluLCBlbnRlcmVkX3Bpbik6CiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzdWNjZXNzZnVsIHZlcmlmaWNhdGlvbgogICAgICAgICAgICBndWkub3Blbl93YWxsZXRfd2luZG93KGxvYWRfd2FsbGV0X2luZm8oa2V5KSwga2V5KQogICAgZWxzZToKICAgICAgICBjb25maXJtX3BpbiA9IGd1aS5waW5fY29uZmlybV9lbnRyeS5nZXQoKQogICAgICAgIGlmIGVudGVyZWRfcGluID09IGNvbmZpcm1fcGluOgogICAgICAgICAgICBzZXRfcGluKGVudGVyZWRfcGluLCBrZXkpCiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIlN1Y2Nlc3MiLCAiTmV3IFBJTiBzZXQgc3VjY2Vzc2Z1bGx5LiIpCiAgICAgICAgICAgIGd1aS5waW5fd2luZG93LmRlc3Ryb3koKSAgIyBDbG9zZSB0aGUgUElOIHdpbmRvdyBhZnRlciBzZXR0aW5nIHRoZSBuZXcgUElOCiAgICAgICAgICAgIGd1aS5vcGVuX3dhbGxldF93aW5kb3cobG9hZF93YWxsZXRfaW5mbyhrZXkpLCBrZXkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIkVycm9yIiwgIlBJTnMgZG8gbm90IG1hdGNoLiBUcnkgYWdhaW4uIikKCmRlZiB2aWV3X2tleXMoY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIGlmIGNyeXB0b190eXBlIGluIHdhbGxldF9pbmZvOgogICAgICAgIHB1Yl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bIndhbGxldCJdCiAgICAgICAgcHJpdl9rZXkgPSB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0KICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKGYie2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0gS2V5cyIsIGYiUHVibGljIEtleToge3B1Yl9rZXl9XG5Qcml2YXRlIEtleToge3ByaXZfa2V5fSIpCiAgICBlbHNlOgogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsIGYiTm8ga2V5cyBmb3VuZCBmb3Ige2NyeXB0b190eXBlLmNhcGl0YWxpemUoKX0uIikKCmRlZiBvbl9nZW5lcmF0ZV9hZGRyZXNzKHdhbGxldF9mcmFtZSwgY3J5cHRvX3R5cGUpOgogICAgd2FsbGV0X2luZm8gPSBsb2FkX3dhbGxldF9pbmZvKGtleSkKICAgIG5ld19hZGRyZXNzLCBwcml2YXRlX2tleSA9IGdlbmVyYXRlX25ld19hZGRyZXNzKGNyeXB0b190eXBlKQogICAgd2FsbGV0X2luZm9bY3J5cHRvX3R5cGVdWyJ3YWxsZXQiXSA9IG5ld19hZGRyZXNzCiAgICB3YWxsZXRfaW5mb1tjcnlwdG9fdHlwZV1bInByaXZhdGVfa2V5Il0gPSBwcml2YXRlX2tleQogICAgc2F2ZV93YWxsZXRfaW5mbyh3YWxsZXRfaW5mbywga2V5KQoKICAgICMgUmVmcmVzaCB3YWxsZXQgd2luZG93CiAgICBndWkub3Blbl93YWxsZXRfd2luZG93KHdhbGxldF9pbmZvLCBrZXkpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAga2V5ID0gbG9hZF9rZXkoKQogICAgcGluID0gZ2V0X3BpbihrZXkpCgogICAgcm9vdCA9IFRrKCkgICMgQ3JlYXRlIHRoZSBtYWluIFRraW50ZXIgcm9vdCB3aW5kb3cKICAgIHJvb3Qud2l0aGRyYXcoKSAgIyBIaWRlIHRoZSBtYWluIHdpbmRvdyBhcyB3ZSBkb24ndCB1c2UgaXQgZGlyZWN0bHkKICAgIAogICAgZ3VpID0gV2FsbGV0R1VJKG9uX2dlbmVyYXRlX2FkZHJlc3MsIHZpZXdfa2V5cywgV2FsbGV0R1VJLmNvcHlfdG9fY2xpcGJvYXJkKQogICAgZ3VpLnNob3dfcGluX3dpbmRvdyhvbl9waW5fZW50cnksIHBpbikKCiAgICByb290Lm1haW5sb29wKCkgICMgU3RhcnQgdGhlIG1haW4gVGtpbnRlciBldmVudCBsb29wCg",
					"AQAAAAAAAAABAAAAAAAAAAAAAADRJwAAAAAAAAAAAAAAAPC/"
				],
				[
					46,
					1,
					"paste",
					null,
					"AgAAAMwiAAAAAAAA1icAAAAAAAAAAAAA1icAAAAAAADWJwAAAAAAAD0AAAAgICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCJFcnJvciIsICJQSU5z",
					"AQAAAAAAAAABAAAAzCIAAAAAAAAJIwAAAAAAAAAAAAAAAPC/"
				],
				[
					52,
					1,
					"right_delete",
					null,
					"AQAAAHsZAAAAAAAAexkAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAexkAAAAAAAB7GQAAAAAAAAAAAAAAAPC/"
				],
				[
					58,
					1,
					"right_delete",
					null,
					"AQAAAMAbAAAAAAAAwBsAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAwBsAAAAAAADAGwAAAAAAAAAAAAAAAPC/"
				]
			]
		}
	],
	"build_system": "",
	"build_system_choices":
	[
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"gitsavvy:",
				"GitSavvy: help"
			],
			[
				"pack",
				"Package Control: List Packages"
			],
			[
				"gitsa",
				"GitSavvy: help"
			],
			[
				"package control: ins",
				"Package Control: Install Package"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"file_history":
	[
		"/C/Users/Paulj/Desktop/Cold wallet/gui.py",
		"/C/Users/Paulj/Desktop/Cold wallet/theme_config.py",
		"/C/Users/Paulj/Desktop/Cold wallet/autorun.inf",
		"/C/Users/Paulj/Desktop/Cold wallet/requirements.txt",
		"/C/Users/Paulj/Desktop/Cold wallet/utils/helpers.py",
		"/C/Users/Paulj/Desktop/Cold wallet/config/settings.py",
		"/C/Users/Paulj/Desktop/Cold wallet/crypto/cryptography.py",
		"/C/Users/Paulj/Desktop/Cold wallet/gui/crypto_management.py",
		"/C/Users/Paulj/Desktop/Cold wallet/gui/pin_entry.py",
		"/C/Users/Paulj/Desktop/Cold wallet/config/data.json",
		"/C/Users/Paulj/Desktop/Cold wallet/main.py",
		"/C/Users/Paulj/Desktop/Cold wallet/gui/helpers.py",
		"/C/Users/Paulj/Desktop/Cold wallet/update_build.bat",
		"/C/Users/Paulj/Desktop/Cold wallet/gui_pin_management.py",
		"/C/Users/Paulj/Desktop/Cold wallet/encryption_key_management.py",
		"/C/Users/Paulj/Documents/GitHub/Website/script.js"
	],
	"find":
	{
		"height": 0.0
	},
	"find_in_files":
	{
		"height": 0.0,
		"where_history":
		[
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"file": "main.py",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 10196,
						"regions":
						{
						},
						"selection":
						[
							[
								7104,
								7104
							]
						],
						"settings":
						{
							"syntax": "Packages/Python/Python.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 2721.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 0.0
	},
	"input":
	{
		"height": 0.0
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			]
		],
		"cols":
		[
			0.0,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.find_results":
	{
		"height": 0.0
	},
	"pinned_build_system": "",
	"project": "cold wallet code.sublime-project",
	"replace":
	{
		"height": 0.0
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_symbol":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"selected_group": 0,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 256.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
